<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>lj_emit_x86.h source code [luajit/lj_emit_x86.h] - Woboq Code Browser</title>
<link rel="stylesheet" href=".././data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href=".././data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src=".././data/jquery/jquery.min.js"></script>
<script type="text/javascript" src=".././data/jquery/jquery-ui.min.js"></script>
<script>var file = 'luajit/lj_emit_x86.h'; var root_path = '..'; var data_path = '.././data'; var ecma_script_api_version = 2;</script>
<script src='.././data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='./'>luajit</a>/<a href='lj_emit_x86.h.html'>lj_emit_x86.h</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/*</i></td></tr>
<tr><th id="2">2</th><td><i>** x86/x64 instruction emitter.</i></td></tr>
<tr><th id="3">3</th><td><i>** Copyright (C) 2005-2021 Mike Pall. See Copyright Notice in luajit.h</i></td></tr>
<tr><th id="4">4</th><td><i>*/</i></td></tr>
<tr><th id="5">5</th><td></td></tr>
<tr><th id="6">6</th><td><i>/* -- Emit basic instructions --------------------------------------------- */</i></td></tr>
<tr><th id="7">7</th><td></td></tr>
<tr><th id="8">8</th><td><u>#define <dfn class="macro" id="_M/MODRM" data-ref="_M/MODRM">MODRM</dfn>(mode, r1, r2)	((<a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a>)((mode)+(((r1)&amp;7)&lt;&lt;3)+((r2)&amp;7)))</u></td></tr>
<tr><th id="9">9</th><td></td></tr>
<tr><th id="10">10</th><td><u>#<span data-ppcond="10">if</span> <a class="macro" href="lj_arch.h.html#600" title="1" data-ref="_M/LJ_64">LJ_64</a></u></td></tr>
<tr><th id="11">11</th><td><u>#define <dfn class="macro" id="_M/REXRB" data-ref="_M/REXRB">REXRB</dfn>(p, rr, rb) \</u></td></tr>
<tr><th id="12">12</th><td><u>    { <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> <dfn class="local col2 decl" id="102rex" title='rex' data-type='MCode' data-ref="102rex" data-ref-filename="102rex">rex</dfn> = 0x40 + (((rr)&gt;&gt;1)&amp;4) + (((rb)&gt;&gt;3)&amp;1); \</u></td></tr>
<tr><th id="13">13</th><td><u>      if (<a class="local col2 ref" href="#289" title='rex' data-ref="102rex" data-ref-filename="102rex">rex</a> != 0x40) *--(p) = <a class="local col2 ref" href="#289" title='rex' data-ref="102rex" data-ref-filename="102rex">rex</a>; }</u></td></tr>
<tr><th id="14">14</th><td><u>#define <dfn class="macro" id="_M/FORCE_REX" data-ref="_M/FORCE_REX">FORCE_REX</dfn>		0x200</u></td></tr>
<tr><th id="15">15</th><td><u>#define <dfn class="macro" id="_M/REX_64" data-ref="_M/REX_64">REX_64</dfn>			(FORCE_REX|0x080000)</u></td></tr>
<tr><th id="16">16</th><td><u>#define <dfn class="macro" id="_M/VEX_64" data-ref="_M/VEX_64">VEX_64</dfn>			0x800000</u></td></tr>
<tr><th id="17">17</th><td><u>#<span data-ppcond="10">else</span></u></td></tr>
<tr><th id="18">18</th><td><u>#define REXRB(p, rr, rb)	((void)0)</u></td></tr>
<tr><th id="19">19</th><td><u>#define FORCE_REX		0</u></td></tr>
<tr><th id="20">20</th><td><u>#define REX_64			0</u></td></tr>
<tr><th id="21">21</th><td><u>#define VEX_64			0</u></td></tr>
<tr><th id="22">22</th><td><u>#<span data-ppcond="10">endif</span></u></td></tr>
<tr><th id="23">23</th><td><u>#<span data-ppcond="23">if</span> <a class="macro" href="lj_arch.h.html#526" title="1" data-ref="_M/LJ_GC64">LJ_GC64</a></u></td></tr>
<tr><th id="24">24</th><td><u>#define <dfn class="macro" id="_M/REX_GC64" data-ref="_M/REX_GC64">REX_GC64</dfn>		REX_64</u></td></tr>
<tr><th id="25">25</th><td><u>#<span data-ppcond="23">else</span></u></td></tr>
<tr><th id="26">26</th><td><u>#define REX_GC64		0</u></td></tr>
<tr><th id="27">27</th><td><u>#<span data-ppcond="23">endif</span></u></td></tr>
<tr><th id="28">28</th><td></td></tr>
<tr><th id="29">29</th><td><u>#define <dfn class="macro" id="_M/emit_i8" data-ref="_M/emit_i8">emit_i8</dfn>(as, i)		(*--as-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='w' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a> = (<a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a>)(i))</u></td></tr>
<tr><th id="30">30</th><td><u>#define <dfn class="macro" id="_M/emit_i32" data-ref="_M/emit_i32">emit_i32</dfn>(as, i)		(*(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> *)(as-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a>-4) = (i), as-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='w' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a> -= 4)</u></td></tr>
<tr><th id="31">31</th><td><u>#define <dfn class="macro" id="_M/emit_u32" data-ref="_M/emit_u32">emit_u32</dfn>(as, u)		(*(uint32_t *)(as-&gt;mcp-4) = (u), as-&gt;mcp -= 4)</u></td></tr>
<tr><th id="32">32</th><td></td></tr>
<tr><th id="33">33</th><td><u>#define <dfn class="macro" id="_M/emit_x87op" data-ref="_M/emit_x87op">emit_x87op</dfn>(as, xo) \</u></td></tr>
<tr><th id="34">34</th><td><u>  (*(uint16_t *)(as-&gt;mcp-2) = (uint16_t)(xo), as-&gt;mcp -= 2)</u></td></tr>
<tr><th id="35">35</th><td></td></tr>
<tr><th id="36">36</th><td><i>/* op */</i></td></tr>
<tr><th id="37">37</th><td><em>static</em> <a class="macro" href="lj_def.h.html#128" title="inline __attribute__((always_inline))" data-ref="_M/LJ_AINLINE">LJ_AINLINE</a> <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="decl def fn" id="emit_op" title='emit_op' data-ref="emit_op" data-ref-filename="emit_op">emit_op</dfn>(<a class="typedef" href="lj_target_x86.h.html#x86Op" title='x86Op' data-type='enum x86Op' data-ref="x86Op" data-ref-filename="x86Op">x86Op</a> <dfn class="local col1 decl" id="41xo" title='xo' data-type='x86Op' data-ref="41xo" data-ref-filename="41xo">xo</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col2 decl" id="42rr" title='rr' data-type='Reg' data-ref="42rr" data-ref-filename="42rr">rr</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col3 decl" id="43rb" title='rb' data-type='Reg' data-ref="43rb" data-ref-filename="43rb">rb</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col4 decl" id="44rx" title='rx' data-type='Reg' data-ref="44rx" data-ref-filename="44rx">rx</dfn>,</td></tr>
<tr><th id="38">38</th><td>				 <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col5 decl" id="45p" title='p' data-type='MCode *' data-ref="45p" data-ref-filename="45p">p</dfn>, <em>int</em> <dfn class="local col6 decl" id="46delta" title='delta' data-type='int' data-ref="46delta" data-ref-filename="46delta">delta</dfn>)</td></tr>
<tr><th id="39">39</th><td>{</td></tr>
<tr><th id="40">40</th><td>  <em>int</em> <dfn class="local col7 decl" id="47n" title='n' data-type='int' data-ref="47n" data-ref-filename="47n">n</dfn> = (<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int8_t" title='int8_t' data-type='__int8_t' data-ref="int8_t" data-ref-filename="int8_t">int8_t</a>)<a class="local col1 ref" href="#41xo" title='xo' data-ref="41xo" data-ref-filename="41xo">xo</a>;</td></tr>
<tr><th id="41">41</th><td>  <b>if</b> (<a class="local col7 ref" href="#47n" title='n' data-ref="47n" data-ref-filename="47n">n</a> == -<var>60</var>) {  <i>/* VEX-encoded instruction */</i></td></tr>
<tr><th id="42">42</th><td><u>#<span data-ppcond="42">if</span> <a class="macro" href="lj_arch.h.html#600" title="1" data-ref="_M/LJ_64">LJ_64</a></u></td></tr>
<tr><th id="43">43</th><td>    <a class="local col1 ref" href="#41xo" title='xo' data-ref="41xo" data-ref-filename="41xo">xo</a> ^= (((<a class="local col2 ref" href="#42rr" title='rr' data-ref="42rr" data-ref-filename="42rr">rr</a>&gt;&gt;<var>1</var>)&amp;<var>4</var>)+((<a class="local col4 ref" href="#44rx" title='rx' data-ref="44rx" data-ref-filename="44rx">rx</a>&gt;&gt;<var>2</var>)&amp;<var>2</var>)+((<a class="local col3 ref" href="#43rb" title='rb' data-ref="43rb" data-ref-filename="43rb">rb</a>&gt;&gt;<var>3</var>)&amp;<var>1</var>))&lt;&lt;<var>13</var>;</td></tr>
<tr><th id="44">44</th><td><u>#<span data-ppcond="42">endif</span></u></td></tr>
<tr><th id="45">45</th><td>    *(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-uintn.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> *)(<a class="local col5 ref" href="#45p" title='p' data-ref="45p" data-ref-filename="45p">p</a>+<a class="local col6 ref" href="#46delta" title='delta' data-ref="46delta" data-ref-filename="46delta">delta</a>-<var>5</var>) = (<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-uintn.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a>)<a class="local col1 ref" href="#41xo" title='xo' data-ref="41xo" data-ref-filename="41xo">xo</a>;</td></tr>
<tr><th id="46">46</th><td>    <b>return</b> <a class="local col5 ref" href="#45p" title='p' data-ref="45p" data-ref-filename="45p">p</a>+<a class="local col6 ref" href="#46delta" title='delta' data-ref="46delta" data-ref-filename="46delta">delta</a>-<var>5</var>;</td></tr>
<tr><th id="47">47</th><td>  }</td></tr>
<tr><th id="48">48</th><td><u>#<span data-ppcond="48">if</span> defined(<span class="macro" data-ref="_M/__GNUC__">__GNUC__</span>) || defined(<span class="macro" data-ref="_M/__clang__">__clang__</span>)</u></td></tr>
<tr><th id="49">49</th><td>  <b>if</b> (<a class="ref fn" href="#49" title='__builtin_constant_p' data-ref="__builtin_constant_p" data-ref-filename="__builtin_constant_p">__builtin_constant_p</a>(<a class="local col1 ref" href="#41xo" title='xo' data-ref="41xo" data-ref-filename="41xo">xo</a>) &amp;&amp; <a class="local col7 ref" href="#47n" title='n' data-ref="47n" data-ref-filename="47n">n</a> == -<var>2</var>)</td></tr>
<tr><th id="50">50</th><td>    <a class="local col5 ref" href="#45p" title='p' data-ref="45p" data-ref-filename="45p">p</a>[<a class="local col6 ref" href="#46delta" title='delta' data-ref="46delta" data-ref-filename="46delta">delta</a>-<var>2</var>] = (<a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a>)(<a class="local col1 ref" href="#41xo" title='xo' data-ref="41xo" data-ref-filename="41xo">xo</a> &gt;&gt; <var>24</var>);</td></tr>
<tr><th id="51">51</th><td>  <b>else</b> <b>if</b> (<a class="ref fn" href="#49" title='__builtin_constant_p' data-ref="__builtin_constant_p" data-ref-filename="__builtin_constant_p">__builtin_constant_p</a>(<a class="local col1 ref" href="#41xo" title='xo' data-ref="41xo" data-ref-filename="41xo">xo</a>) &amp;&amp; <a class="local col7 ref" href="#47n" title='n' data-ref="47n" data-ref-filename="47n">n</a> == -<var>3</var>)</td></tr>
<tr><th id="52">52</th><td>    *(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-uintn.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a> *)(<a class="local col5 ref" href="#45p" title='p' data-ref="45p" data-ref-filename="45p">p</a>+<a class="local col6 ref" href="#46delta" title='delta' data-ref="46delta" data-ref-filename="46delta">delta</a>-<var>3</var>) = (<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-uintn.h.html#uint16_t" title='uint16_t' data-type='__uint16_t' data-ref="uint16_t" data-ref-filename="uint16_t">uint16_t</a>)(<a class="local col1 ref" href="#41xo" title='xo' data-ref="41xo" data-ref-filename="41xo">xo</a> &gt;&gt; <var>16</var>);</td></tr>
<tr><th id="53">53</th><td>  <b>else</b></td></tr>
<tr><th id="54">54</th><td><u>#<span data-ppcond="48">endif</span></u></td></tr>
<tr><th id="55">55</th><td>    *(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-uintn.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> *)(<a class="local col5 ref" href="#45p" title='p' data-ref="45p" data-ref-filename="45p">p</a>+<a class="local col6 ref" href="#46delta" title='delta' data-ref="46delta" data-ref-filename="46delta">delta</a>-<var>5</var>) = (<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-uintn.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a>)<a class="local col1 ref" href="#41xo" title='xo' data-ref="41xo" data-ref-filename="41xo">xo</a>;</td></tr>
<tr><th id="56">56</th><td>  <a class="local col5 ref" href="#45p" title='p' data-ref="45p" data-ref-filename="45p">p</a> += <a class="local col7 ref" href="#47n" title='n' data-ref="47n" data-ref-filename="47n">n</a> + <a class="local col6 ref" href="#46delta" title='delta' data-ref="46delta" data-ref-filename="46delta">delta</a>;</td></tr>
<tr><th id="57">57</th><td><u>#<span data-ppcond="57">if</span> <a class="macro" href="lj_arch.h.html#600" title="1" data-ref="_M/LJ_64">LJ_64</a></u></td></tr>
<tr><th id="58">58</th><td>  {</td></tr>
<tr><th id="59">59</th><td>    <a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-uintn.h.html#uint32_t" title='uint32_t' data-type='__uint32_t' data-ref="uint32_t" data-ref-filename="uint32_t">uint32_t</a> <dfn class="local col8 decl" id="48rex" title='rex' data-type='uint32_t' data-ref="48rex" data-ref-filename="48rex">rex</dfn> = <var>0x40</var> + ((<a class="local col2 ref" href="#42rr" title='rr' data-ref="42rr" data-ref-filename="42rr">rr</a>&gt;&gt;<var>1</var>)&amp;(<var>4</var>+(<a class="macro" href="#14" title="0x200" data-ref="_M/FORCE_REX">FORCE_REX</a>&gt;&gt;<var>1</var>)))+((<a class="local col4 ref" href="#44rx" title='rx' data-ref="44rx" data-ref-filename="44rx">rx</a>&gt;&gt;<var>2</var>)&amp;<var>2</var>)+((<a class="local col3 ref" href="#43rb" title='rb' data-ref="43rb" data-ref-filename="43rb">rb</a>&gt;&gt;<var>3</var>)&amp;<var>1</var>);</td></tr>
<tr><th id="60">60</th><td>    <b>if</b> (<a class="local col8 ref" href="#48rex" title='rex' data-ref="48rex" data-ref-filename="48rex">rex</a> != <var>0x40</var>) {</td></tr>
<tr><th id="61">61</th><td>      <a class="local col8 ref" href="#48rex" title='rex' data-ref="48rex" data-ref-filename="48rex">rex</a> |= (<a class="local col2 ref" href="#42rr" title='rr' data-ref="42rr" data-ref-filename="42rr">rr</a> &gt;&gt; <var>16</var>);</td></tr>
<tr><th id="62">62</th><td>      <b>if</b> (<a class="local col7 ref" href="#47n" title='n' data-ref="47n" data-ref-filename="47n">n</a> == -<var>4</var>) { *<a class="local col5 ref" href="#45p" title='p' data-ref="45p" data-ref-filename="45p">p</a> = (<a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a>)<a class="local col8 ref" href="#48rex" title='rex' data-ref="48rex" data-ref-filename="48rex">rex</a>; <a class="local col8 ref" href="#48rex" title='rex' data-ref="48rex" data-ref-filename="48rex">rex</a> = (<a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a>)(<a class="local col1 ref" href="#41xo" title='xo' data-ref="41xo" data-ref-filename="41xo">xo</a> &gt;&gt; <var>8</var>); }</td></tr>
<tr><th id="63">63</th><td>      <b>else</b> <b>if</b> ((<a class="local col1 ref" href="#41xo" title='xo' data-ref="41xo" data-ref-filename="41xo">xo</a> &amp; <var>0xffffff</var>) == <var>0x6600fd</var>) { *<a class="local col5 ref" href="#45p" title='p' data-ref="45p" data-ref-filename="45p">p</a> = (<a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a>)<a class="local col8 ref" href="#48rex" title='rex' data-ref="48rex" data-ref-filename="48rex">rex</a>; <a class="local col8 ref" href="#48rex" title='rex' data-ref="48rex" data-ref-filename="48rex">rex</a> = <var>0x66</var>; }</td></tr>
<tr><th id="64">64</th><td>      *--<a class="local col5 ref" href="#45p" title='p' data-ref="45p" data-ref-filename="45p">p</a> = (<a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a>)<a class="local col8 ref" href="#48rex" title='rex' data-ref="48rex" data-ref-filename="48rex">rex</a>;</td></tr>
<tr><th id="65">65</th><td>    }</td></tr>
<tr><th id="66">66</th><td>  }</td></tr>
<tr><th id="67">67</th><td><u>#<span data-ppcond="57">else</span></u></td></tr>
<tr><th id="68">68</th><td>  UNUSED(rr); UNUSED(rb); UNUSED(rx);</td></tr>
<tr><th id="69">69</th><td><u>#<span data-ppcond="57">endif</span></u></td></tr>
<tr><th id="70">70</th><td>  <b>return</b> <a class="local col5 ref" href="#45p" title='p' data-ref="45p" data-ref-filename="45p">p</a>;</td></tr>
<tr><th id="71">71</th><td>}</td></tr>
<tr><th id="72">72</th><td></td></tr>
<tr><th id="73">73</th><td><i>/* op + modrm */</i></td></tr>
<tr><th id="74">74</th><td><u>#define <dfn class="macro" id="_M/emit_opm" data-ref="_M/emit_opm">emit_opm</dfn>(xo, mode, rr, rb, p, delta) \</u></td></tr>
<tr><th id="75">75</th><td><u>  (p[(delta)-1] = MODRM((mode), (rr), (rb)), \</u></td></tr>
<tr><th id="76">76</th><td><u>   <a class="ref fn" href="#emit_op" title='emit_op' data-ref="emit_op" data-ref-filename="emit_op">emit_op</a>((xo), (rr), (rb), 0, (p), (delta)))</u></td></tr>
<tr><th id="77">77</th><td></td></tr>
<tr><th id="78">78</th><td><i>/* op + modrm + sib */</i></td></tr>
<tr><th id="79">79</th><td><u>#define <dfn class="macro" id="_M/emit_opmx" data-ref="_M/emit_opmx">emit_opmx</dfn>(xo, mode, scale, rr, rb, rx, p) \</u></td></tr>
<tr><th id="80">80</th><td><u>  (p[-1] = MODRM((scale), (rx), (rb)), \</u></td></tr>
<tr><th id="81">81</th><td><u>   p[-2] = MODRM((mode), (rr), <a class="enum" href="lj_target_x86.h.html#30" title='RID_ESP' data-ref="RID_ESP" data-ref-filename="RID_ESP">RID_ESP</a>), \</u></td></tr>
<tr><th id="82">82</th><td><u>   <a class="ref fn" href="#emit_op" title='emit_op' data-ref="emit_op" data-ref-filename="emit_op">emit_op</a>((xo), (rr), (rb), (rx), (p), -1))</u></td></tr>
<tr><th id="83">83</th><td></td></tr>
<tr><th id="84">84</th><td><i>/* op r1, r2 */</i></td></tr>
<tr><th id="85">85</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_rr" title='emit_rr' data-ref="emit_rr" data-ref-filename="emit_rr">emit_rr</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col9 decl" id="49as" title='as' data-type='ASMState *' data-ref="49as" data-ref-filename="49as">as</dfn>, <a class="typedef" href="lj_target_x86.h.html#x86Op" title='x86Op' data-type='enum x86Op' data-ref="x86Op" data-ref-filename="x86Op">x86Op</a> <dfn class="local col0 decl" id="50xo" title='xo' data-type='x86Op' data-ref="50xo" data-ref-filename="50xo">xo</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col1 decl" id="51r1" title='r1' data-type='Reg' data-ref="51r1" data-ref-filename="51r1">r1</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col2 decl" id="52r2" title='r2' data-type='Reg' data-ref="52r2" data-ref-filename="52r2">r2</dfn>)</td></tr>
<tr><th id="86">86</th><td>{</td></tr>
<tr><th id="87">87</th><td>  <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col3 decl" id="53p" title='p' data-type='MCode *' data-ref="53p" data-ref-filename="53p">p</dfn> = <a class="local col9 ref" href="#49as" title='as' data-ref="49as" data-ref-filename="49as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a>;</td></tr>
<tr><th id="88">88</th><td>  <a class="local col9 ref" href="#49as" title='as' data-ref="49as" data-ref-filename="49as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='w' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a> = <a class="macro" href="#74" title="(p[(0)-1] = ((MCode)(((XM_REG))+((((r1))&amp;7)&lt;&lt;3)+(((r2))&amp;7))), emit_op((xo), (r1), (r2), 0, (p), (0)))" data-ref="_M/emit_opm">emit_opm</a>(<a class="local col0 ref" href="#50xo" title='xo' data-ref="50xo" data-ref-filename="50xo">xo</a>, <a class="enum" href="lj_target_x86.h.html#XM_REG" title='XM_REG' data-ref="XM_REG" data-ref-filename="XM_REG">XM_REG</a>, <a class="local col1 ref" href="#51r1" title='r1' data-ref="51r1" data-ref-filename="51r1">r1</a>, <a class="local col2 ref" href="#52r2" title='r2' data-ref="52r2" data-ref-filename="52r2">r2</a>, <a class="local col3 ref" href="#53p" title='p' data-ref="53p" data-ref-filename="53p">p</a>, <var>0</var>);</td></tr>
<tr><th id="89">89</th><td>}</td></tr>
<tr><th id="90">90</th><td></td></tr>
<tr><th id="91">91</th><td><u>#<span data-ppcond="91">if</span> <a class="macro" href="lj_arch.h.html#600" title="1" data-ref="_M/LJ_64">LJ_64</a> &amp;&amp; defined(<span class="macro" data-ref="_M/LUA_USE_ASSERT">LUA_USE_ASSERT</span>)</u></td></tr>
<tr><th id="92">92</th><td><i>/* [addr] is sign-extended in x64 and must be in lower 2G (not 4G). */</i></td></tr>
<tr><th id="93">93</th><td><em>static</em> int32_t ptr2addr(<em>const</em> <em>void</em> *p)</td></tr>
<tr><th id="94">94</th><td>{</td></tr>
<tr><th id="95">95</th><td>  lj_assertX((uintptr_t)p &lt; (uintptr_t)<var>0x80000000</var>, <q>"pointer outside 2G range"</q>);</td></tr>
<tr><th id="96">96</th><td>  <b>return</b> i32ptr(p);</td></tr>
<tr><th id="97">97</th><td>}</td></tr>
<tr><th id="98">98</th><td><u>#<span data-ppcond="91">else</span></u></td></tr>
<tr><th id="99">99</th><td><u>#define <dfn class="macro" id="_M/ptr2addr" data-ref="_M/ptr2addr">ptr2addr</dfn>(p)	(i32ptr((p)))</u></td></tr>
<tr><th id="100">100</th><td><u>#<span data-ppcond="91">endif</span></u></td></tr>
<tr><th id="101">101</th><td></td></tr>
<tr><th id="102">102</th><td><i>/* op r, [base+ofs] */</i></td></tr>
<tr><th id="103">103</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_rmro" title='emit_rmro' data-ref="emit_rmro" data-ref-filename="emit_rmro">emit_rmro</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col4 decl" id="54as" title='as' data-type='ASMState *' data-ref="54as" data-ref-filename="54as">as</dfn>, <a class="typedef" href="lj_target_x86.h.html#x86Op" title='x86Op' data-type='enum x86Op' data-ref="x86Op" data-ref-filename="x86Op">x86Op</a> <dfn class="local col5 decl" id="55xo" title='xo' data-type='x86Op' data-ref="55xo" data-ref-filename="55xo">xo</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col6 decl" id="56rr" title='rr' data-type='Reg' data-ref="56rr" data-ref-filename="56rr">rr</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col7 decl" id="57rb" title='rb' data-type='Reg' data-ref="57rb" data-ref-filename="57rb">rb</dfn>, <a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> <dfn class="local col8 decl" id="58ofs" title='ofs' data-type='int32_t' data-ref="58ofs" data-ref-filename="58ofs">ofs</dfn>)</td></tr>
<tr><th id="104">104</th><td>{</td></tr>
<tr><th id="105">105</th><td>  <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col9 decl" id="59p" title='p' data-type='MCode *' data-ref="59p" data-ref-filename="59p">p</dfn> = <a class="local col4 ref" href="#54as" title='as' data-ref="54as" data-ref-filename="54as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a>;</td></tr>
<tr><th id="106">106</th><td>  <a class="typedef" href="lj_target_x86.h.html#x86Mode" title='x86Mode' data-type='enum x86Mode' data-ref="x86Mode" data-ref-filename="x86Mode">x86Mode</a> <dfn class="local col0 decl" id="60mode" title='mode' data-type='x86Mode' data-ref="60mode" data-ref-filename="60mode">mode</dfn>;</td></tr>
<tr><th id="107">107</th><td>  <b>if</b> (<a class="macro" href="lj_target.h.html#28" title="(!((rb) &amp; 0x80))" data-ref="_M/ra_hasreg">ra_hasreg</a>(<a class="local col7 ref" href="#57rb" title='rb' data-ref="57rb" data-ref-filename="57rb">rb</a>)) {</td></tr>
<tr><th id="108">108</th><td>    <b>if</b> (<a class="macro" href="lj_arch.h.html#526" title="1" data-ref="_M/LJ_GC64">LJ_GC64</a> &amp;&amp; <a class="local col7 ref" href="#57rb" title='rb' data-ref="57rb" data-ref-filename="57rb">rb</a> == <a class="enum" href="lj_target_x86.h.html#RID_RIP" title='RID_RIP' data-ref="RID_RIP" data-ref-filename="RID_RIP">RID_RIP</a>) {</td></tr>
<tr><th id="109">109</th><td>      <a class="local col0 ref" href="#60mode" title='mode' data-ref="60mode" data-ref-filename="60mode">mode</a> = <a class="enum" href="lj_target_x86.h.html#XM_OFS0" title='XM_OFS0' data-ref="XM_OFS0" data-ref-filename="XM_OFS0">XM_OFS0</a>;</td></tr>
<tr><th id="110">110</th><td>      <a class="local col9 ref" href="#59p" title='p' data-ref="59p" data-ref-filename="59p">p</a> -= <var>4</var>;</td></tr>
<tr><th id="111">111</th><td>      *(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> *)<a class="local col9 ref" href="#59p" title='p' data-ref="59p" data-ref-filename="59p">p</a> = <a class="local col8 ref" href="#58ofs" title='ofs' data-ref="58ofs" data-ref-filename="58ofs">ofs</a>;</td></tr>
<tr><th id="112">112</th><td>    } <b>else</b> <b>if</b> (<a class="local col8 ref" href="#58ofs" title='ofs' data-ref="58ofs" data-ref-filename="58ofs">ofs</a> == <var>0</var> &amp;&amp; (<a class="local col7 ref" href="#57rb" title='rb' data-ref="57rb" data-ref-filename="57rb">rb</a>&amp;<var>7</var>) != <a class="enum" href="lj_target_x86.h.html#30" title='RID_EBP' data-ref="RID_EBP" data-ref-filename="RID_EBP">RID_EBP</a>) {</td></tr>
<tr><th id="113">113</th><td>      <a class="local col0 ref" href="#60mode" title='mode' data-ref="60mode" data-ref-filename="60mode">mode</a> = <a class="enum" href="lj_target_x86.h.html#XM_OFS0" title='XM_OFS0' data-ref="XM_OFS0" data-ref-filename="XM_OFS0">XM_OFS0</a>;</td></tr>
<tr><th id="114">114</th><td>    } <b>else</b> <b>if</b> (<a class="macro" href="lj_def.h.html#101" title="((ofs) == (int32_t)(int8_t)(ofs))" data-ref="_M/checki8">checki8</a>(<a class="local col8 ref" href="#58ofs" title='ofs' data-ref="58ofs" data-ref-filename="58ofs">ofs</a>)) {</td></tr>
<tr><th id="115">115</th><td>      *--<a class="local col9 ref" href="#59p" title='p' data-ref="59p" data-ref-filename="59p">p</a> = (<a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a>)<a class="local col8 ref" href="#58ofs" title='ofs' data-ref="58ofs" data-ref-filename="58ofs">ofs</a>;</td></tr>
<tr><th id="116">116</th><td>      <a class="local col0 ref" href="#60mode" title='mode' data-ref="60mode" data-ref-filename="60mode">mode</a> = <a class="enum" href="lj_target_x86.h.html#XM_OFS8" title='XM_OFS8' data-ref="XM_OFS8" data-ref-filename="XM_OFS8">XM_OFS8</a>;</td></tr>
<tr><th id="117">117</th><td>    } <b>else</b> {</td></tr>
<tr><th id="118">118</th><td>      <a class="local col9 ref" href="#59p" title='p' data-ref="59p" data-ref-filename="59p">p</a> -= <var>4</var>;</td></tr>
<tr><th id="119">119</th><td>      *(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> *)<a class="local col9 ref" href="#59p" title='p' data-ref="59p" data-ref-filename="59p">p</a> = <a class="local col8 ref" href="#58ofs" title='ofs' data-ref="58ofs" data-ref-filename="58ofs">ofs</a>;</td></tr>
<tr><th id="120">120</th><td>      <a class="local col0 ref" href="#60mode" title='mode' data-ref="60mode" data-ref-filename="60mode">mode</a> = <a class="enum" href="lj_target_x86.h.html#XM_OFS32" title='XM_OFS32' data-ref="XM_OFS32" data-ref-filename="XM_OFS32">XM_OFS32</a>;</td></tr>
<tr><th id="121">121</th><td>    }</td></tr>
<tr><th id="122">122</th><td>    <b>if</b> ((<a class="local col7 ref" href="#57rb" title='rb' data-ref="57rb" data-ref-filename="57rb">rb</a>&amp;<var>7</var>) == <a class="enum" href="lj_target_x86.h.html#30" title='RID_ESP' data-ref="RID_ESP" data-ref-filename="RID_ESP">RID_ESP</a>)</td></tr>
<tr><th id="123">123</th><td>      *--<a class="local col9 ref" href="#59p" title='p' data-ref="59p" data-ref-filename="59p">p</a> = <a class="macro" href="#8" title="((MCode)((XM_SCALE1)+(((RID_ESP)&amp;7)&lt;&lt;3)+((RID_ESP)&amp;7)))" data-ref="_M/MODRM">MODRM</a>(<a class="enum" href="lj_target_x86.h.html#XM_SCALE1" title='XM_SCALE1' data-ref="XM_SCALE1" data-ref-filename="XM_SCALE1">XM_SCALE1</a>, <a class="enum" href="lj_target_x86.h.html#30" title='RID_ESP' data-ref="RID_ESP" data-ref-filename="RID_ESP">RID_ESP</a>, <a class="enum" href="lj_target_x86.h.html#30" title='RID_ESP' data-ref="RID_ESP" data-ref-filename="RID_ESP">RID_ESP</a>);</td></tr>
<tr><th id="124">124</th><td>  } <b>else</b> {</td></tr>
<tr><th id="125">125</th><td>    *(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> *)(<a class="local col9 ref" href="#59p" title='p' data-ref="59p" data-ref-filename="59p">p</a>-<var>4</var>) = <a class="local col8 ref" href="#58ofs" title='ofs' data-ref="58ofs" data-ref-filename="58ofs">ofs</a>;</td></tr>
<tr><th id="126">126</th><td><u>#<span data-ppcond="126">if</span> <a class="macro" href="lj_arch.h.html#600" title="1" data-ref="_M/LJ_64">LJ_64</a></u></td></tr>
<tr><th id="127">127</th><td>    <a class="local col9 ref" href="#59p" title='p' data-ref="59p" data-ref-filename="59p">p</a>[-<var>5</var>] = <a class="macro" href="#8" title="((MCode)((XM_SCALE1)+(((RID_ESP)&amp;7)&lt;&lt;3)+((RID_EBP)&amp;7)))" data-ref="_M/MODRM">MODRM</a>(<a class="enum" href="lj_target_x86.h.html#XM_SCALE1" title='XM_SCALE1' data-ref="XM_SCALE1" data-ref-filename="XM_SCALE1">XM_SCALE1</a>, <a class="enum" href="lj_target_x86.h.html#30" title='RID_ESP' data-ref="RID_ESP" data-ref-filename="RID_ESP">RID_ESP</a>, <a class="enum" href="lj_target_x86.h.html#30" title='RID_EBP' data-ref="RID_EBP" data-ref-filename="RID_EBP">RID_EBP</a>);</td></tr>
<tr><th id="128">128</th><td>    <a class="local col9 ref" href="#59p" title='p' data-ref="59p" data-ref-filename="59p">p</a> -= <var>5</var>;</td></tr>
<tr><th id="129">129</th><td>    <a class="local col7 ref" href="#57rb" title='rb' data-ref="57rb" data-ref-filename="57rb">rb</a> = <a class="enum" href="lj_target_x86.h.html#30" title='RID_ESP' data-ref="RID_ESP" data-ref-filename="RID_ESP">RID_ESP</a>;</td></tr>
<tr><th id="130">130</th><td><u>#<span data-ppcond="126">else</span></u></td></tr>
<tr><th id="131">131</th><td>    p -= <var>4</var>;</td></tr>
<tr><th id="132">132</th><td>    rb = RID_EBP;</td></tr>
<tr><th id="133">133</th><td><u>#<span data-ppcond="126">endif</span></u></td></tr>
<tr><th id="134">134</th><td>    <a class="local col0 ref" href="#60mode" title='mode' data-ref="60mode" data-ref-filename="60mode">mode</a> = <a class="enum" href="lj_target_x86.h.html#XM_OFS0" title='XM_OFS0' data-ref="XM_OFS0" data-ref-filename="XM_OFS0">XM_OFS0</a>;</td></tr>
<tr><th id="135">135</th><td>  }</td></tr>
<tr><th id="136">136</th><td>  <a class="local col4 ref" href="#54as" title='as' data-ref="54as" data-ref-filename="54as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='w' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a> = <a class="macro" href="#74" title="(p[(0)-1] = ((MCode)(((mode))+((((rr))&amp;7)&lt;&lt;3)+(((rb))&amp;7))), emit_op((xo), (rr), (rb), 0, (p), (0)))" data-ref="_M/emit_opm">emit_opm</a>(<a class="local col5 ref" href="#55xo" title='xo' data-ref="55xo" data-ref-filename="55xo">xo</a>, <a class="local col0 ref" href="#60mode" title='mode' data-ref="60mode" data-ref-filename="60mode">mode</a>, <a class="local col6 ref" href="#56rr" title='rr' data-ref="56rr" data-ref-filename="56rr">rr</a>, <a class="local col7 ref" href="#57rb" title='rb' data-ref="57rb" data-ref-filename="57rb">rb</a>, <a class="local col9 ref" href="#59p" title='p' data-ref="59p" data-ref-filename="59p">p</a>, <var>0</var>);</td></tr>
<tr><th id="137">137</th><td>}</td></tr>
<tr><th id="138">138</th><td></td></tr>
<tr><th id="139">139</th><td><i>/* op r, [base+idx*scale+ofs] */</i></td></tr>
<tr><th id="140">140</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_rmrxo" title='emit_rmrxo' data-ref="emit_rmrxo" data-ref-filename="emit_rmrxo">emit_rmrxo</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col1 decl" id="61as" title='as' data-type='ASMState *' data-ref="61as" data-ref-filename="61as">as</dfn>, <a class="typedef" href="lj_target_x86.h.html#x86Op" title='x86Op' data-type='enum x86Op' data-ref="x86Op" data-ref-filename="x86Op">x86Op</a> <dfn class="local col2 decl" id="62xo" title='xo' data-type='x86Op' data-ref="62xo" data-ref-filename="62xo">xo</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col3 decl" id="63rr" title='rr' data-type='Reg' data-ref="63rr" data-ref-filename="63rr">rr</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col4 decl" id="64rb" title='rb' data-type='Reg' data-ref="64rb" data-ref-filename="64rb">rb</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col5 decl" id="65rx" title='rx' data-type='Reg' data-ref="65rx" data-ref-filename="65rx">rx</dfn>,</td></tr>
<tr><th id="141">141</th><td>		       <a class="typedef" href="lj_target_x86.h.html#x86Mode" title='x86Mode' data-type='enum x86Mode' data-ref="x86Mode" data-ref-filename="x86Mode">x86Mode</a> <dfn class="local col6 decl" id="66scale" title='scale' data-type='x86Mode' data-ref="66scale" data-ref-filename="66scale">scale</dfn>, <a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> <dfn class="local col7 decl" id="67ofs" title='ofs' data-type='int32_t' data-ref="67ofs" data-ref-filename="67ofs">ofs</dfn>)</td></tr>
<tr><th id="142">142</th><td>{</td></tr>
<tr><th id="143">143</th><td>  <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col8 decl" id="68p" title='p' data-type='MCode *' data-ref="68p" data-ref-filename="68p">p</dfn> = <a class="local col1 ref" href="#61as" title='as' data-ref="61as" data-ref-filename="61as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a>;</td></tr>
<tr><th id="144">144</th><td>  <a class="typedef" href="lj_target_x86.h.html#x86Mode" title='x86Mode' data-type='enum x86Mode' data-ref="x86Mode" data-ref-filename="x86Mode">x86Mode</a> <dfn class="local col9 decl" id="69mode" title='mode' data-type='x86Mode' data-ref="69mode" data-ref-filename="69mode">mode</dfn>;</td></tr>
<tr><th id="145">145</th><td>  <b>if</b> (<a class="local col7 ref" href="#67ofs" title='ofs' data-ref="67ofs" data-ref-filename="67ofs">ofs</a> == <var>0</var> &amp;&amp; (<a class="local col4 ref" href="#64rb" title='rb' data-ref="64rb" data-ref-filename="64rb">rb</a>&amp;<var>7</var>) != <a class="enum" href="lj_target_x86.h.html#30" title='RID_EBP' data-ref="RID_EBP" data-ref-filename="RID_EBP">RID_EBP</a>) {</td></tr>
<tr><th id="146">146</th><td>    <a class="local col9 ref" href="#69mode" title='mode' data-ref="69mode" data-ref-filename="69mode">mode</a> = <a class="enum" href="lj_target_x86.h.html#XM_OFS0" title='XM_OFS0' data-ref="XM_OFS0" data-ref-filename="XM_OFS0">XM_OFS0</a>;</td></tr>
<tr><th id="147">147</th><td>  } <b>else</b> <b>if</b> (<a class="macro" href="lj_def.h.html#101" title="((ofs) == (int32_t)(int8_t)(ofs))" data-ref="_M/checki8">checki8</a>(<a class="local col7 ref" href="#67ofs" title='ofs' data-ref="67ofs" data-ref-filename="67ofs">ofs</a>)) {</td></tr>
<tr><th id="148">148</th><td>    <a class="local col9 ref" href="#69mode" title='mode' data-ref="69mode" data-ref-filename="69mode">mode</a> = <a class="enum" href="lj_target_x86.h.html#XM_OFS8" title='XM_OFS8' data-ref="XM_OFS8" data-ref-filename="XM_OFS8">XM_OFS8</a>;</td></tr>
<tr><th id="149">149</th><td>    *--<a class="local col8 ref" href="#68p" title='p' data-ref="68p" data-ref-filename="68p">p</a> = (<a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a>)<a class="local col7 ref" href="#67ofs" title='ofs' data-ref="67ofs" data-ref-filename="67ofs">ofs</a>;</td></tr>
<tr><th id="150">150</th><td>  } <b>else</b> {</td></tr>
<tr><th id="151">151</th><td>    <a class="local col9 ref" href="#69mode" title='mode' data-ref="69mode" data-ref-filename="69mode">mode</a> = <a class="enum" href="lj_target_x86.h.html#XM_OFS32" title='XM_OFS32' data-ref="XM_OFS32" data-ref-filename="XM_OFS32">XM_OFS32</a>;</td></tr>
<tr><th id="152">152</th><td>    <a class="local col8 ref" href="#68p" title='p' data-ref="68p" data-ref-filename="68p">p</a> -= <var>4</var>;</td></tr>
<tr><th id="153">153</th><td>    *(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> *)<a class="local col8 ref" href="#68p" title='p' data-ref="68p" data-ref-filename="68p">p</a> = <a class="local col7 ref" href="#67ofs" title='ofs' data-ref="67ofs" data-ref-filename="67ofs">ofs</a>;</td></tr>
<tr><th id="154">154</th><td>  }</td></tr>
<tr><th id="155">155</th><td>  <a class="local col1 ref" href="#61as" title='as' data-ref="61as" data-ref-filename="61as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='w' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a> = <a class="macro" href="#79" title="(p[-1] = ((MCode)(((scale))+((((rx))&amp;7)&lt;&lt;3)+(((rb))&amp;7))), p[-2] = ((MCode)(((mode))+((((rr))&amp;7)&lt;&lt;3)+((RID_ESP)&amp;7))), emit_op((xo), (rr), (rb), (rx), (p), -1))" data-ref="_M/emit_opmx">emit_opmx</a>(<a class="local col2 ref" href="#62xo" title='xo' data-ref="62xo" data-ref-filename="62xo">xo</a>, <a class="local col9 ref" href="#69mode" title='mode' data-ref="69mode" data-ref-filename="69mode">mode</a>, <a class="local col6 ref" href="#66scale" title='scale' data-ref="66scale" data-ref-filename="66scale">scale</a>, <a class="local col3 ref" href="#63rr" title='rr' data-ref="63rr" data-ref-filename="63rr">rr</a>, <a class="local col4 ref" href="#64rb" title='rb' data-ref="64rb" data-ref-filename="64rb">rb</a>, <a class="local col5 ref" href="#65rx" title='rx' data-ref="65rx" data-ref-filename="65rx">rx</a>, <a class="local col8 ref" href="#68p" title='p' data-ref="68p" data-ref-filename="68p">p</a>);</td></tr>
<tr><th id="156">156</th><td>}</td></tr>
<tr><th id="157">157</th><td></td></tr>
<tr><th id="158">158</th><td><i>/* op r, i */</i></td></tr>
<tr><th id="159">159</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_gri" title='emit_gri' data-ref="emit_gri" data-ref-filename="emit_gri">emit_gri</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col0 decl" id="70as" title='as' data-type='ASMState *' data-ref="70as" data-ref-filename="70as">as</dfn>, <a class="typedef" href="lj_target_x86.h.html#x86Group" title='x86Group' data-type='uint32_t' data-ref="x86Group" data-ref-filename="x86Group">x86Group</a> <dfn class="local col1 decl" id="71xg" title='xg' data-type='x86Group' data-ref="71xg" data-ref-filename="71xg">xg</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col2 decl" id="72rb" title='rb' data-type='Reg' data-ref="72rb" data-ref-filename="72rb">rb</dfn>, <a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> <dfn class="local col3 decl" id="73i" title='i' data-type='int32_t' data-ref="73i" data-ref-filename="73i">i</dfn>)</td></tr>
<tr><th id="160">160</th><td>{</td></tr>
<tr><th id="161">161</th><td>  <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col4 decl" id="74p" title='p' data-type='MCode *' data-ref="74p" data-ref-filename="74p">p</dfn> = <a class="local col0 ref" href="#70as" title='as' data-ref="70as" data-ref-filename="70as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a>;</td></tr>
<tr><th id="162">162</th><td>  <a class="typedef" href="lj_target_x86.h.html#x86Op" title='x86Op' data-type='enum x86Op' data-ref="x86Op" data-ref-filename="x86Op">x86Op</a> <dfn class="local col5 decl" id="75xo" title='xo' data-type='x86Op' data-ref="75xo" data-ref-filename="75xo">xo</dfn>;</td></tr>
<tr><th id="163">163</th><td>  <b>if</b> (<a class="macro" href="lj_def.h.html#101" title="((i) == (int32_t)(int8_t)(i))" data-ref="_M/checki8">checki8</a>(<a class="local col3 ref" href="#73i" title='i' data-ref="73i" data-ref-filename="73i">i</a>)) {</td></tr>
<tr><th id="164">164</th><td>    *--<a class="local col4 ref" href="#74p" title='p' data-ref="74p" data-ref-filename="74p">p</a> = (<a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a>)<a class="local col3 ref" href="#73i" title='i' data-ref="73i" data-ref-filename="73i">i</a>;</td></tr>
<tr><th id="165">165</th><td>    <a class="local col5 ref" href="#75xo" title='xo' data-ref="75xo" data-ref-filename="75xo">xo</a> = <a class="macro" href="lj_target_x86.h.html#326" title="((x86Op)(0x000000fe + (((xg)&lt;&lt;8) &amp; 0xff000000)))" data-ref="_M/XG_TOXOi8">XG_TOXOi8</a>(<a class="local col1 ref" href="#71xg" title='xg' data-ref="71xg" data-ref-filename="71xg">xg</a>);</td></tr>
<tr><th id="166">166</th><td>  } <b>else</b> {</td></tr>
<tr><th id="167">167</th><td>    <a class="local col4 ref" href="#74p" title='p' data-ref="74p" data-ref-filename="74p">p</a> -= <var>4</var>;</td></tr>
<tr><th id="168">168</th><td>    *(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> *)<a class="local col4 ref" href="#74p" title='p' data-ref="74p" data-ref-filename="74p">p</a> = <a class="local col3 ref" href="#73i" title='i' data-ref="73i" data-ref-filename="73i">i</a>;</td></tr>
<tr><th id="169">169</th><td>    <a class="local col5 ref" href="#75xo" title='xo' data-ref="75xo" data-ref-filename="75xo">xo</a> = <a class="macro" href="lj_target_x86.h.html#325" title="((x86Op)(0x000000fe + (((xg)&lt;&lt;16) &amp; 0xff000000)))" data-ref="_M/XG_TOXOi">XG_TOXOi</a>(<a class="local col1 ref" href="#71xg" title='xg' data-ref="71xg" data-ref-filename="71xg">xg</a>);</td></tr>
<tr><th id="170">170</th><td>  }</td></tr>
<tr><th id="171">171</th><td>  <a class="local col0 ref" href="#70as" title='as' data-ref="70as" data-ref-filename="70as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='w' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a> = <a class="macro" href="#74" title="(p[(0)-1] = ((MCode)(((XM_REG))+(((((Reg)(xg &amp; 7) | (rb &amp; (0x200|0x080000))))&amp;7)&lt;&lt;3)+(((rb))&amp;7))), emit_op((xo), ((Reg)(xg &amp; 7) | (rb &amp; (0x200|0x080000))), (rb), 0, (p), (0)))" data-ref="_M/emit_opm">emit_opm</a>(<a class="local col5 ref" href="#75xo" title='xo' data-ref="75xo" data-ref-filename="75xo">xo</a>, <a class="enum" href="lj_target_x86.h.html#XM_REG" title='XM_REG' data-ref="XM_REG" data-ref-filename="XM_REG">XM_REG</a>, (<a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a>)(<a class="local col1 ref" href="#71xg" title='xg' data-ref="71xg" data-ref-filename="71xg">xg</a> &amp; <var>7</var>) | (<a class="local col2 ref" href="#72rb" title='rb' data-ref="72rb" data-ref-filename="72rb">rb</a> &amp; <a class="macro" href="#15" title="(0x200|0x080000)" data-ref="_M/REX_64">REX_64</a>), <a class="local col2 ref" href="#72rb" title='rb' data-ref="72rb" data-ref-filename="72rb">rb</a>, <a class="local col4 ref" href="#74p" title='p' data-ref="74p" data-ref-filename="74p">p</a>, <var>0</var>);</td></tr>
<tr><th id="172">172</th><td>}</td></tr>
<tr><th id="173">173</th><td></td></tr>
<tr><th id="174">174</th><td><i>/* op [base+ofs], i */</i></td></tr>
<tr><th id="175">175</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_gmroi" title='emit_gmroi' data-ref="emit_gmroi" data-ref-filename="emit_gmroi">emit_gmroi</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col6 decl" id="76as" title='as' data-type='ASMState *' data-ref="76as" data-ref-filename="76as">as</dfn>, <a class="typedef" href="lj_target_x86.h.html#x86Group" title='x86Group' data-type='uint32_t' data-ref="x86Group" data-ref-filename="x86Group">x86Group</a> <dfn class="local col7 decl" id="77xg" title='xg' data-type='x86Group' data-ref="77xg" data-ref-filename="77xg">xg</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col8 decl" id="78rb" title='rb' data-type='Reg' data-ref="78rb" data-ref-filename="78rb">rb</dfn>, <a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> <dfn class="local col9 decl" id="79ofs" title='ofs' data-type='int32_t' data-ref="79ofs" data-ref-filename="79ofs">ofs</dfn>,</td></tr>
<tr><th id="176">176</th><td>		       <a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> <dfn class="local col0 decl" id="80i" title='i' data-type='int32_t' data-ref="80i" data-ref-filename="80i">i</dfn>)</td></tr>
<tr><th id="177">177</th><td>{</td></tr>
<tr><th id="178">178</th><td>  <a class="typedef" href="lj_target_x86.h.html#x86Op" title='x86Op' data-type='enum x86Op' data-ref="x86Op" data-ref-filename="x86Op">x86Op</a> <dfn class="local col1 decl" id="81xo" title='xo' data-type='x86Op' data-ref="81xo" data-ref-filename="81xo">xo</dfn>;</td></tr>
<tr><th id="179">179</th><td>  <b>if</b> (<a class="macro" href="lj_def.h.html#101" title="((i) == (int32_t)(int8_t)(i))" data-ref="_M/checki8">checki8</a>(<a class="local col0 ref" href="#80i" title='i' data-ref="80i" data-ref-filename="80i">i</a>)) {</td></tr>
<tr><th id="180">180</th><td>    <a class="macro" href="#29" title="(*--as-&gt;mcp = (MCode)(i))" data-ref="_M/emit_i8">emit_i8</a>(<a class="local col6 ref" href="#76as" title='as' data-ref="76as" data-ref-filename="76as">as</a>, <a class="local col0 ref" href="#80i" title='i' data-ref="80i" data-ref-filename="80i">i</a>);</td></tr>
<tr><th id="181">181</th><td>    <a class="local col1 ref" href="#81xo" title='xo' data-ref="81xo" data-ref-filename="81xo">xo</a> = <a class="macro" href="lj_target_x86.h.html#326" title="((x86Op)(0x000000fe + (((xg)&lt;&lt;8) &amp; 0xff000000)))" data-ref="_M/XG_TOXOi8">XG_TOXOi8</a>(<a class="local col7 ref" href="#77xg" title='xg' data-ref="77xg" data-ref-filename="77xg">xg</a>);</td></tr>
<tr><th id="182">182</th><td>  } <b>else</b> {</td></tr>
<tr><th id="183">183</th><td>    <a class="macro" href="#30" title="(*(int32_t *)(as-&gt;mcp-4) = (i), as-&gt;mcp -= 4)" data-ref="_M/emit_i32">emit_i32</a>(<a class="local col6 ref" href="#76as" title='as' data-ref="76as" data-ref-filename="76as">as</a>, <a class="local col0 ref" href="#80i" title='i' data-ref="80i" data-ref-filename="80i">i</a>);</td></tr>
<tr><th id="184">184</th><td>    <a class="local col1 ref" href="#81xo" title='xo' data-ref="81xo" data-ref-filename="81xo">xo</a> = <a class="macro" href="lj_target_x86.h.html#325" title="((x86Op)(0x000000fe + (((xg)&lt;&lt;16) &amp; 0xff000000)))" data-ref="_M/XG_TOXOi">XG_TOXOi</a>(<a class="local col7 ref" href="#77xg" title='xg' data-ref="77xg" data-ref-filename="77xg">xg</a>);</td></tr>
<tr><th id="185">185</th><td>  }</td></tr>
<tr><th id="186">186</th><td>  <a class="ref fn" href="#emit_rmro" title='emit_rmro' data-ref="emit_rmro" data-ref-filename="emit_rmro">emit_rmro</a>(<a class="local col6 ref" href="#76as" title='as' data-ref="76as" data-ref-filename="76as">as</a>, <a class="local col1 ref" href="#81xo" title='xo' data-ref="81xo" data-ref-filename="81xo">xo</a>, (<a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a>)(<a class="local col7 ref" href="#77xg" title='xg' data-ref="77xg" data-ref-filename="77xg">xg</a> &amp; <var>7</var>), <a class="local col8 ref" href="#78rb" title='rb' data-ref="78rb" data-ref-filename="78rb">rb</a>, <a class="local col9 ref" href="#79ofs" title='ofs' data-ref="79ofs" data-ref-filename="79ofs">ofs</a>);</td></tr>
<tr><th id="187">187</th><td>}</td></tr>
<tr><th id="188">188</th><td></td></tr>
<tr><th id="189">189</th><td><u>#define <dfn class="macro" id="_M/emit_shifti" data-ref="_M/emit_shifti">emit_shifti</dfn>(as, xg, r, i) \</u></td></tr>
<tr><th id="190">190</th><td><u>  (emit_i8(as, (i)), emit_rr(as, XO_SHIFTi, (Reg)(xg), (r)))</u></td></tr>
<tr><th id="191">191</th><td></td></tr>
<tr><th id="192">192</th><td><i>/* op r, rm/mrm */</i></td></tr>
<tr><th id="193">193</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_mrm" title='emit_mrm' data-ref="emit_mrm" data-ref-filename="emit_mrm">emit_mrm</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col2 decl" id="82as" title='as' data-type='ASMState *' data-ref="82as" data-ref-filename="82as">as</dfn>, <a class="typedef" href="lj_target_x86.h.html#x86Op" title='x86Op' data-type='enum x86Op' data-ref="x86Op" data-ref-filename="x86Op">x86Op</a> <dfn class="local col3 decl" id="83xo" title='xo' data-type='x86Op' data-ref="83xo" data-ref-filename="83xo">xo</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col4 decl" id="84rr" title='rr' data-type='Reg' data-ref="84rr" data-ref-filename="84rr">rr</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col5 decl" id="85rb" title='rb' data-type='Reg' data-ref="85rb" data-ref-filename="85rb">rb</dfn>)</td></tr>
<tr><th id="194">194</th><td>{</td></tr>
<tr><th id="195">195</th><td>  <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col6 decl" id="86p" title='p' data-type='MCode *' data-ref="86p" data-ref-filename="86p">p</dfn> = <a class="local col2 ref" href="#82as" title='as' data-ref="82as" data-ref-filename="82as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a>;</td></tr>
<tr><th id="196">196</th><td>  <a class="typedef" href="lj_target_x86.h.html#x86Mode" title='x86Mode' data-type='enum x86Mode' data-ref="x86Mode" data-ref-filename="x86Mode">x86Mode</a> <dfn class="local col7 decl" id="87mode" title='mode' data-type='x86Mode' data-ref="87mode" data-ref-filename="87mode">mode</dfn> = <a class="enum" href="lj_target_x86.h.html#XM_REG" title='XM_REG' data-ref="XM_REG" data-ref-filename="XM_REG">XM_REG</a>;</td></tr>
<tr><th id="197">197</th><td>  <b>if</b> (<a class="local col5 ref" href="#85rb" title='rb' data-ref="85rb" data-ref-filename="85rb">rb</a> == <a class="enum" href="lj_target_x86.h.html#RID_MRM" title='RID_MRM' data-ref="RID_MRM" data-ref-filename="RID_MRM">RID_MRM</a>) {</td></tr>
<tr><th id="198">198</th><td>    <a class="local col5 ref" href="#85rb" title='rb' data-ref="85rb" data-ref-filename="85rb">rb</a> = <a class="local col2 ref" href="#82as" title='as' data-ref="82as" data-ref-filename="82as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mrm" title='ASMState::mrm' data-use='m' data-ref="ASMState::mrm" data-ref-filename="ASMState..mrm">mrm</a>.<a class="ref field" href="lj_target_x86.h.html#(anonymous)::base" title='(anonymous struct)::base' data-ref="(anonymous)::base" data-ref-filename="(anonymous)..base">base</a>;</td></tr>
<tr><th id="199">199</th><td>    <b>if</b> (<a class="local col5 ref" href="#85rb" title='rb' data-ref="85rb" data-ref-filename="85rb">rb</a> == <a class="macro" href="lj_target.h.html#21" title="0x80" data-ref="_M/RID_NONE">RID_NONE</a>) {</td></tr>
<tr><th id="200">200</th><td>      <a class="local col5 ref" href="#85rb" title='rb' data-ref="85rb" data-ref-filename="85rb">rb</a> = <a class="enum" href="lj_target_x86.h.html#30" title='RID_EBP' data-ref="RID_EBP" data-ref-filename="RID_EBP">RID_EBP</a>;</td></tr>
<tr><th id="201">201</th><td>      <a class="local col7 ref" href="#87mode" title='mode' data-ref="87mode" data-ref-filename="87mode">mode</a> = <a class="enum" href="lj_target_x86.h.html#XM_OFS0" title='XM_OFS0' data-ref="XM_OFS0" data-ref-filename="XM_OFS0">XM_OFS0</a>;</td></tr>
<tr><th id="202">202</th><td>      <a class="local col6 ref" href="#86p" title='p' data-ref="86p" data-ref-filename="86p">p</a> -= <var>4</var>;</td></tr>
<tr><th id="203">203</th><td>      *(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> *)<a class="local col6 ref" href="#86p" title='p' data-ref="86p" data-ref-filename="86p">p</a> = <a class="local col2 ref" href="#82as" title='as' data-ref="82as" data-ref-filename="82as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mrm" title='ASMState::mrm' data-use='m' data-ref="ASMState::mrm" data-ref-filename="ASMState..mrm">mrm</a>.<a class="ref field" href="lj_target_x86.h.html#(anonymous)::ofs" title='(anonymous struct)::ofs' data-ref="(anonymous)::ofs" data-ref-filename="(anonymous)..ofs">ofs</a>;</td></tr>
<tr><th id="204">204</th><td>      <b>if</b> (<a class="local col2 ref" href="#82as" title='as' data-ref="82as" data-ref-filename="82as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mrm" title='ASMState::mrm' data-use='m' data-ref="ASMState::mrm" data-ref-filename="ASMState..mrm">mrm</a>.<a class="ref field" href="lj_target_x86.h.html#(anonymous)::idx" title='(anonymous struct)::idx' data-ref="(anonymous)::idx" data-ref-filename="(anonymous)..idx">idx</a> != <a class="macro" href="lj_target.h.html#21" title="0x80" data-ref="_M/RID_NONE">RID_NONE</a>)</td></tr>
<tr><th id="205">205</th><td>	<b>goto</b> <a class="lbl" href="#88mrmidx" data-ref="88mrmidx" data-ref-filename="88mrmidx">mrmidx</a>;</td></tr>
<tr><th id="206">206</th><td><u>#<span data-ppcond="206">if</span> <a class="macro" href="lj_arch.h.html#600" title="1" data-ref="_M/LJ_64">LJ_64</a></u></td></tr>
<tr><th id="207">207</th><td>      *--<a class="local col6 ref" href="#86p" title='p' data-ref="86p" data-ref-filename="86p">p</a> = <a class="macro" href="#8" title="((MCode)((XM_SCALE1)+(((RID_ESP)&amp;7)&lt;&lt;3)+((RID_EBP)&amp;7)))" data-ref="_M/MODRM">MODRM</a>(<a class="enum" href="lj_target_x86.h.html#XM_SCALE1" title='XM_SCALE1' data-ref="XM_SCALE1" data-ref-filename="XM_SCALE1">XM_SCALE1</a>, <a class="enum" href="lj_target_x86.h.html#30" title='RID_ESP' data-ref="RID_ESP" data-ref-filename="RID_ESP">RID_ESP</a>, <a class="enum" href="lj_target_x86.h.html#30" title='RID_EBP' data-ref="RID_EBP" data-ref-filename="RID_EBP">RID_EBP</a>);</td></tr>
<tr><th id="208">208</th><td>      <a class="local col5 ref" href="#85rb" title='rb' data-ref="85rb" data-ref-filename="85rb">rb</a> = <a class="enum" href="lj_target_x86.h.html#30" title='RID_ESP' data-ref="RID_ESP" data-ref-filename="RID_ESP">RID_ESP</a>;</td></tr>
<tr><th id="209">209</th><td><u>#<span data-ppcond="206">endif</span></u></td></tr>
<tr><th id="210">210</th><td>    } <b>else</b> <b>if</b> (<a class="macro" href="lj_arch.h.html#526" title="1" data-ref="_M/LJ_GC64">LJ_GC64</a> &amp;&amp; <a class="local col5 ref" href="#85rb" title='rb' data-ref="85rb" data-ref-filename="85rb">rb</a> == <a class="enum" href="lj_target_x86.h.html#RID_RIP" title='RID_RIP' data-ref="RID_RIP" data-ref-filename="RID_RIP">RID_RIP</a>) {</td></tr>
<tr><th id="211">211</th><td>      <a class="macro" href="lj_asm.c.html#106" title="((void)as)" data-ref="_M/lj_assertA">lj_assertA</a>(as-&gt;mrm.idx == RID_NONE, <q>"RIP-rel mrm cannot have index"</q>);</td></tr>
<tr><th id="212">212</th><td>      <a class="local col7 ref" href="#87mode" title='mode' data-ref="87mode" data-ref-filename="87mode">mode</a> = <a class="enum" href="lj_target_x86.h.html#XM_OFS0" title='XM_OFS0' data-ref="XM_OFS0" data-ref-filename="XM_OFS0">XM_OFS0</a>;</td></tr>
<tr><th id="213">213</th><td>      <a class="local col6 ref" href="#86p" title='p' data-ref="86p" data-ref-filename="86p">p</a> -= <var>4</var>;</td></tr>
<tr><th id="214">214</th><td>      *(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> *)<a class="local col6 ref" href="#86p" title='p' data-ref="86p" data-ref-filename="86p">p</a> = <a class="local col2 ref" href="#82as" title='as' data-ref="82as" data-ref-filename="82as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mrm" title='ASMState::mrm' data-use='m' data-ref="ASMState::mrm" data-ref-filename="ASMState..mrm">mrm</a>.<a class="ref field" href="lj_target_x86.h.html#(anonymous)::ofs" title='(anonymous struct)::ofs' data-ref="(anonymous)::ofs" data-ref-filename="(anonymous)..ofs">ofs</a>;</td></tr>
<tr><th id="215">215</th><td>    } <b>else</b> {</td></tr>
<tr><th id="216">216</th><td>      <b>if</b> (<a class="local col2 ref" href="#82as" title='as' data-ref="82as" data-ref-filename="82as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mrm" title='ASMState::mrm' data-use='m' data-ref="ASMState::mrm" data-ref-filename="ASMState..mrm">mrm</a>.<a class="ref field" href="lj_target_x86.h.html#(anonymous)::ofs" title='(anonymous struct)::ofs' data-ref="(anonymous)::ofs" data-ref-filename="(anonymous)..ofs">ofs</a> == <var>0</var> &amp;&amp; (<a class="local col5 ref" href="#85rb" title='rb' data-ref="85rb" data-ref-filename="85rb">rb</a>&amp;<var>7</var>) != <a class="enum" href="lj_target_x86.h.html#30" title='RID_EBP' data-ref="RID_EBP" data-ref-filename="RID_EBP">RID_EBP</a>) {</td></tr>
<tr><th id="217">217</th><td>	<a class="local col7 ref" href="#87mode" title='mode' data-ref="87mode" data-ref-filename="87mode">mode</a> = <a class="enum" href="lj_target_x86.h.html#XM_OFS0" title='XM_OFS0' data-ref="XM_OFS0" data-ref-filename="XM_OFS0">XM_OFS0</a>;</td></tr>
<tr><th id="218">218</th><td>      } <b>else</b> <b>if</b> (<a class="macro" href="lj_def.h.html#101" title="((as-&gt;mrm.ofs) == (int32_t)(int8_t)(as-&gt;mrm.ofs))" data-ref="_M/checki8">checki8</a>(<a class="local col2 ref" href="#82as" title='as' data-ref="82as" data-ref-filename="82as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mrm" title='ASMState::mrm' data-use='m' data-ref="ASMState::mrm" data-ref-filename="ASMState..mrm">mrm</a>.<a class="ref field" href="lj_target_x86.h.html#(anonymous)::ofs" title='(anonymous struct)::ofs' data-ref="(anonymous)::ofs" data-ref-filename="(anonymous)..ofs">ofs</a>)) {</td></tr>
<tr><th id="219">219</th><td>	*--<a class="local col6 ref" href="#86p" title='p' data-ref="86p" data-ref-filename="86p">p</a> = (<a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a>)<a class="local col2 ref" href="#82as" title='as' data-ref="82as" data-ref-filename="82as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mrm" title='ASMState::mrm' data-use='m' data-ref="ASMState::mrm" data-ref-filename="ASMState..mrm">mrm</a>.<a class="ref field" href="lj_target_x86.h.html#(anonymous)::ofs" title='(anonymous struct)::ofs' data-ref="(anonymous)::ofs" data-ref-filename="(anonymous)..ofs">ofs</a>;</td></tr>
<tr><th id="220">220</th><td>	<a class="local col7 ref" href="#87mode" title='mode' data-ref="87mode" data-ref-filename="87mode">mode</a> = <a class="enum" href="lj_target_x86.h.html#XM_OFS8" title='XM_OFS8' data-ref="XM_OFS8" data-ref-filename="XM_OFS8">XM_OFS8</a>;</td></tr>
<tr><th id="221">221</th><td>      } <b>else</b> {</td></tr>
<tr><th id="222">222</th><td>	<a class="local col6 ref" href="#86p" title='p' data-ref="86p" data-ref-filename="86p">p</a> -= <var>4</var>;</td></tr>
<tr><th id="223">223</th><td>	*(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> *)<a class="local col6 ref" href="#86p" title='p' data-ref="86p" data-ref-filename="86p">p</a> = <a class="local col2 ref" href="#82as" title='as' data-ref="82as" data-ref-filename="82as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mrm" title='ASMState::mrm' data-use='m' data-ref="ASMState::mrm" data-ref-filename="ASMState..mrm">mrm</a>.<a class="ref field" href="lj_target_x86.h.html#(anonymous)::ofs" title='(anonymous struct)::ofs' data-ref="(anonymous)::ofs" data-ref-filename="(anonymous)..ofs">ofs</a>;</td></tr>
<tr><th id="224">224</th><td>	<a class="local col7 ref" href="#87mode" title='mode' data-ref="87mode" data-ref-filename="87mode">mode</a> = <a class="enum" href="lj_target_x86.h.html#XM_OFS32" title='XM_OFS32' data-ref="XM_OFS32" data-ref-filename="XM_OFS32">XM_OFS32</a>;</td></tr>
<tr><th id="225">225</th><td>      }</td></tr>
<tr><th id="226">226</th><td>      <b>if</b> (<a class="local col2 ref" href="#82as" title='as' data-ref="82as" data-ref-filename="82as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mrm" title='ASMState::mrm' data-use='m' data-ref="ASMState::mrm" data-ref-filename="ASMState..mrm">mrm</a>.<a class="ref field" href="lj_target_x86.h.html#(anonymous)::idx" title='(anonymous struct)::idx' data-ref="(anonymous)::idx" data-ref-filename="(anonymous)..idx">idx</a> != <a class="macro" href="lj_target.h.html#21" title="0x80" data-ref="_M/RID_NONE">RID_NONE</a>) {</td></tr>
<tr><th id="227">227</th><td>      <dfn class="lbl" id="88mrmidx" data-ref="88mrmidx" data-ref-filename="88mrmidx">mrmidx</dfn>:</td></tr>
<tr><th id="228">228</th><td>	<a class="local col2 ref" href="#82as" title='as' data-ref="82as" data-ref-filename="82as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='w' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a> = <a class="macro" href="#79" title="(p[-1] = ((MCode)(((as-&gt;mrm.scale))+((((as-&gt;mrm.idx))&amp;7)&lt;&lt;3)+(((rb))&amp;7))), p[-2] = ((MCode)(((mode))+((((rr))&amp;7)&lt;&lt;3)+((RID_ESP)&amp;7))), emit_op((xo), (rr), (rb), (as-&gt;mrm.idx), (p), -1))" data-ref="_M/emit_opmx">emit_opmx</a>(<a class="local col3 ref" href="#83xo" title='xo' data-ref="83xo" data-ref-filename="83xo">xo</a>, <a class="local col7 ref" href="#87mode" title='mode' data-ref="87mode" data-ref-filename="87mode">mode</a>, <a class="local col2 ref" href="#82as" title='as' data-ref="82as" data-ref-filename="82as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mrm" title='ASMState::mrm' data-use='m' data-ref="ASMState::mrm" data-ref-filename="ASMState..mrm">mrm</a>.<a class="ref field" href="lj_target_x86.h.html#(anonymous)::scale" title='(anonymous struct)::scale' data-ref="(anonymous)::scale" data-ref-filename="(anonymous)..scale">scale</a>, <a class="local col4 ref" href="#84rr" title='rr' data-ref="84rr" data-ref-filename="84rr">rr</a>, <a class="local col5 ref" href="#85rb" title='rb' data-ref="85rb" data-ref-filename="85rb">rb</a>, <a class="local col2 ref" href="#82as" title='as' data-ref="82as" data-ref-filename="82as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mrm" title='ASMState::mrm' data-use='m' data-ref="ASMState::mrm" data-ref-filename="ASMState..mrm">mrm</a>.<a class="ref field" href="lj_target_x86.h.html#(anonymous)::idx" title='(anonymous struct)::idx' data-ref="(anonymous)::idx" data-ref-filename="(anonymous)..idx">idx</a>, <a class="local col6 ref" href="#86p" title='p' data-ref="86p" data-ref-filename="86p">p</a>);</td></tr>
<tr><th id="229">229</th><td>	<b>return</b>;</td></tr>
<tr><th id="230">230</th><td>      }</td></tr>
<tr><th id="231">231</th><td>      <b>if</b> ((<a class="local col5 ref" href="#85rb" title='rb' data-ref="85rb" data-ref-filename="85rb">rb</a>&amp;<var>7</var>) == <a class="enum" href="lj_target_x86.h.html#30" title='RID_ESP' data-ref="RID_ESP" data-ref-filename="RID_ESP">RID_ESP</a>)</td></tr>
<tr><th id="232">232</th><td>	*--<a class="local col6 ref" href="#86p" title='p' data-ref="86p" data-ref-filename="86p">p</a> = <a class="macro" href="#8" title="((MCode)((XM_SCALE1)+(((RID_ESP)&amp;7)&lt;&lt;3)+((RID_ESP)&amp;7)))" data-ref="_M/MODRM">MODRM</a>(<a class="enum" href="lj_target_x86.h.html#XM_SCALE1" title='XM_SCALE1' data-ref="XM_SCALE1" data-ref-filename="XM_SCALE1">XM_SCALE1</a>, <a class="enum" href="lj_target_x86.h.html#30" title='RID_ESP' data-ref="RID_ESP" data-ref-filename="RID_ESP">RID_ESP</a>, <a class="enum" href="lj_target_x86.h.html#30" title='RID_ESP' data-ref="RID_ESP" data-ref-filename="RID_ESP">RID_ESP</a>);</td></tr>
<tr><th id="233">233</th><td>    }</td></tr>
<tr><th id="234">234</th><td>  }</td></tr>
<tr><th id="235">235</th><td>  <a class="local col2 ref" href="#82as" title='as' data-ref="82as" data-ref-filename="82as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='w' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a> = <a class="macro" href="#74" title="(p[(0)-1] = ((MCode)(((mode))+((((rr))&amp;7)&lt;&lt;3)+(((rb))&amp;7))), emit_op((xo), (rr), (rb), 0, (p), (0)))" data-ref="_M/emit_opm">emit_opm</a>(<a class="local col3 ref" href="#83xo" title='xo' data-ref="83xo" data-ref-filename="83xo">xo</a>, <a class="local col7 ref" href="#87mode" title='mode' data-ref="87mode" data-ref-filename="87mode">mode</a>, <a class="local col4 ref" href="#84rr" title='rr' data-ref="84rr" data-ref-filename="84rr">rr</a>, <a class="local col5 ref" href="#85rb" title='rb' data-ref="85rb" data-ref-filename="85rb">rb</a>, <a class="local col6 ref" href="#86p" title='p' data-ref="86p" data-ref-filename="86p">p</a>, <var>0</var>);</td></tr>
<tr><th id="236">236</th><td>}</td></tr>
<tr><th id="237">237</th><td></td></tr>
<tr><th id="238">238</th><td><i>/* op rm/mrm, i */</i></td></tr>
<tr><th id="239">239</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_gmrmi" title='emit_gmrmi' data-ref="emit_gmrmi" data-ref-filename="emit_gmrmi">emit_gmrmi</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col9 decl" id="89as" title='as' data-type='ASMState *' data-ref="89as" data-ref-filename="89as">as</dfn>, <a class="typedef" href="lj_target_x86.h.html#x86Group" title='x86Group' data-type='uint32_t' data-ref="x86Group" data-ref-filename="x86Group">x86Group</a> <dfn class="local col0 decl" id="90xg" title='xg' data-type='x86Group' data-ref="90xg" data-ref-filename="90xg">xg</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col1 decl" id="91rb" title='rb' data-type='Reg' data-ref="91rb" data-ref-filename="91rb">rb</dfn>, <a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> <dfn class="local col2 decl" id="92i" title='i' data-type='int32_t' data-ref="92i" data-ref-filename="92i">i</dfn>)</td></tr>
<tr><th id="240">240</th><td>{</td></tr>
<tr><th id="241">241</th><td>  <a class="typedef" href="lj_target_x86.h.html#x86Op" title='x86Op' data-type='enum x86Op' data-ref="x86Op" data-ref-filename="x86Op">x86Op</a> <dfn class="local col3 decl" id="93xo" title='xo' data-type='x86Op' data-ref="93xo" data-ref-filename="93xo">xo</dfn>;</td></tr>
<tr><th id="242">242</th><td>  <b>if</b> (<a class="macro" href="lj_def.h.html#101" title="((i) == (int32_t)(int8_t)(i))" data-ref="_M/checki8">checki8</a>(<a class="local col2 ref" href="#92i" title='i' data-ref="92i" data-ref-filename="92i">i</a>)) {</td></tr>
<tr><th id="243">243</th><td>    <a class="macro" href="#29" title="(*--as-&gt;mcp = (MCode)(i))" data-ref="_M/emit_i8">emit_i8</a>(<a class="local col9 ref" href="#89as" title='as' data-ref="89as" data-ref-filename="89as">as</a>, <a class="local col2 ref" href="#92i" title='i' data-ref="92i" data-ref-filename="92i">i</a>);</td></tr>
<tr><th id="244">244</th><td>    <a class="local col3 ref" href="#93xo" title='xo' data-ref="93xo" data-ref-filename="93xo">xo</a> = <a class="macro" href="lj_target_x86.h.html#326" title="((x86Op)(0x000000fe + (((xg)&lt;&lt;8) &amp; 0xff000000)))" data-ref="_M/XG_TOXOi8">XG_TOXOi8</a>(<a class="local col0 ref" href="#90xg" title='xg' data-ref="90xg" data-ref-filename="90xg">xg</a>);</td></tr>
<tr><th id="245">245</th><td>  } <b>else</b> {</td></tr>
<tr><th id="246">246</th><td>    <a class="macro" href="#30" title="(*(int32_t *)(as-&gt;mcp-4) = (i), as-&gt;mcp -= 4)" data-ref="_M/emit_i32">emit_i32</a>(<a class="local col9 ref" href="#89as" title='as' data-ref="89as" data-ref-filename="89as">as</a>, <a class="local col2 ref" href="#92i" title='i' data-ref="92i" data-ref-filename="92i">i</a>);</td></tr>
<tr><th id="247">247</th><td>    <a class="local col3 ref" href="#93xo" title='xo' data-ref="93xo" data-ref-filename="93xo">xo</a> = <a class="macro" href="lj_target_x86.h.html#325" title="((x86Op)(0x000000fe + (((xg)&lt;&lt;16) &amp; 0xff000000)))" data-ref="_M/XG_TOXOi">XG_TOXOi</a>(<a class="local col0 ref" href="#90xg" title='xg' data-ref="90xg" data-ref-filename="90xg">xg</a>);</td></tr>
<tr><th id="248">248</th><td>  }</td></tr>
<tr><th id="249">249</th><td>  <a class="ref fn" href="#emit_mrm" title='emit_mrm' data-ref="emit_mrm" data-ref-filename="emit_mrm">emit_mrm</a>(<a class="local col9 ref" href="#89as" title='as' data-ref="89as" data-ref-filename="89as">as</a>, <a class="local col3 ref" href="#93xo" title='xo' data-ref="93xo" data-ref-filename="93xo">xo</a>, (<a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a>)(<a class="local col0 ref" href="#90xg" title='xg' data-ref="90xg" data-ref-filename="90xg">xg</a> &amp; <var>7</var>) | (<a class="local col1 ref" href="#91rb" title='rb' data-ref="91rb" data-ref-filename="91rb">rb</a> &amp; <a class="macro" href="#15" title="(0x200|0x080000)" data-ref="_M/REX_64">REX_64</a>), (<a class="local col1 ref" href="#91rb" title='rb' data-ref="91rb" data-ref-filename="91rb">rb</a> &amp; ~<a class="macro" href="#15" title="(0x200|0x080000)" data-ref="_M/REX_64">REX_64</a>));</td></tr>
<tr><th id="250">250</th><td>}</td></tr>
<tr><th id="251">251</th><td></td></tr>
<tr><th id="252">252</th><td><i>/* -- Emit loads/stores --------------------------------------------------- */</i></td></tr>
<tr><th id="253">253</th><td></td></tr>
<tr><th id="254">254</th><td><i>/* mov [base+ofs], i */</i></td></tr>
<tr><th id="255">255</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_movmroi" title='emit_movmroi' data-ref="emit_movmroi" data-ref-filename="emit_movmroi">emit_movmroi</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col4 decl" id="94as" title='as' data-type='ASMState *' data-ref="94as" data-ref-filename="94as">as</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col5 decl" id="95base" title='base' data-type='Reg' data-ref="95base" data-ref-filename="95base">base</dfn>, <a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> <dfn class="local col6 decl" id="96ofs" title='ofs' data-type='int32_t' data-ref="96ofs" data-ref-filename="96ofs">ofs</dfn>, <a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> <dfn class="local col7 decl" id="97i" title='i' data-type='int32_t' data-ref="97i" data-ref-filename="97i">i</dfn>)</td></tr>
<tr><th id="256">256</th><td>{</td></tr>
<tr><th id="257">257</th><td>  <a class="macro" href="#30" title="(*(int32_t *)(as-&gt;mcp-4) = (i), as-&gt;mcp -= 4)" data-ref="_M/emit_i32">emit_i32</a>(<a class="local col4 ref" href="#94as" title='as' data-ref="94as" data-ref-filename="94as">as</a>, <a class="local col7 ref" href="#97i" title='i' data-ref="97i" data-ref-filename="97i">i</a>);</td></tr>
<tr><th id="258">258</th><td>  <a class="ref fn" href="#emit_rmro" title='emit_rmro' data-ref="emit_rmro" data-ref-filename="emit_rmro">emit_rmro</a>(<a class="local col4 ref" href="#94as" title='as' data-ref="94as" data-ref-filename="94as">as</a>, <a class="enum" href="lj_target_x86.h.html#XO_MOVmi" title='XO_MOVmi' data-ref="XO_MOVmi" data-ref-filename="XO_MOVmi">XO_MOVmi</a>, <var>0</var>, <a class="local col5 ref" href="#95base" title='base' data-ref="95base" data-ref-filename="95base">base</a>, <a class="local col6 ref" href="#96ofs" title='ofs' data-ref="96ofs" data-ref-filename="96ofs">ofs</a>);</td></tr>
<tr><th id="259">259</th><td>}</td></tr>
<tr><th id="260">260</th><td></td></tr>
<tr><th id="261">261</th><td><i>/* mov [base+ofs], r */</i></td></tr>
<tr><th id="262">262</th><td><u>#define <dfn class="macro" id="_M/emit_movtomro" data-ref="_M/emit_movtomro">emit_movtomro</dfn>(as, r, base, ofs) \</u></td></tr>
<tr><th id="263">263</th><td><u>  emit_rmro(as, XO_MOVto, (r), (base), (ofs))</u></td></tr>
<tr><th id="264">264</th><td></td></tr>
<tr><th id="265">265</th><td><i>/* Get/set global_State fields. */</i></td></tr>
<tr><th id="266">266</th><td><u>#define <dfn class="macro" id="_M/emit_opgl" data-ref="_M/emit_opgl">emit_opgl</dfn>(as, xo, r, field) \</u></td></tr>
<tr><th id="267">267</th><td><u>  emit_rma(as, (xo), (r), (void *)&amp;J2G(as-&gt;J)-&gt;field)</u></td></tr>
<tr><th id="268">268</th><td><u>#define <dfn class="macro" id="_M/emit_getgl" data-ref="_M/emit_getgl">emit_getgl</dfn>(as, r, field) emit_opgl(as, XO_MOV, (r)|REX_GC64, field)</u></td></tr>
<tr><th id="269">269</th><td><u>#define <dfn class="macro" id="_M/emit_setgl" data-ref="_M/emit_setgl">emit_setgl</dfn>(as, r, field) emit_opgl(as, XO_MOVto, (r)|REX_GC64, field)</u></td></tr>
<tr><th id="270">270</th><td></td></tr>
<tr><th id="271">271</th><td><u>#define <dfn class="macro" id="_M/emit_setvmstate" data-ref="_M/emit_setvmstate">emit_setvmstate</dfn>(as, i) \</u></td></tr>
<tr><th id="272">272</th><td><u>  (emit_i32(as, i), emit_opgl(as, XO_MOVmi, 0, vmstate))</u></td></tr>
<tr><th id="273">273</th><td></td></tr>
<tr><th id="274">274</th><td><i>/* mov r, i / xor r, r */</i></td></tr>
<tr><th id="275">275</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_loadi" title='emit_loadi' data-ref="emit_loadi" data-ref-filename="emit_loadi">emit_loadi</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col8 decl" id="98as" title='as' data-type='ASMState *' data-ref="98as" data-ref-filename="98as">as</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col9 decl" id="99r" title='r' data-type='Reg' data-ref="99r" data-ref-filename="99r">r</dfn>, <a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> <dfn class="local col0 decl" id="100i" title='i' data-type='int32_t' data-ref="100i" data-ref-filename="100i">i</dfn>)</td></tr>
<tr><th id="276">276</th><td>{</td></tr>
<tr><th id="277">277</th><td>  <i>/* XOR r,r is shorter, but modifies the flags. This is bad for HIOP/jcc. */</i></td></tr>
<tr><th id="278">278</th><td>  <b>if</b> (<a class="local col0 ref" href="#100i" title='i' data-ref="100i" data-ref-filename="100i">i</a> == <var>0</var> &amp;&amp; !(<a class="macro" href="lj_arch.h.html#599" title="0" data-ref="_M/LJ_32">LJ_32</a> &amp;&amp; (<a class="macro" href="lj_asm.c.html#109" title="(&amp;as-&gt;ir[(as-&gt;curins)])" data-ref="_M/IR">IR</a>(<a class="local col8 ref" href="#98as" title='as' data-ref="98as" data-ref-filename="98as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::curins" title='ASMState::curins' data-use='r' data-ref="ASMState::curins" data-ref-filename="ASMState..curins">curins</a>)-&gt;<a class="ref field" href="lj_ir.h.html#551" title='IRIns::(anonymous struct)::o' data-ref="IRIns::(anonymous)::o" data-ref-filename="IRIns..(anonymous)..o">o</a> == <a class="enum" href="lj_ir.h.html#154" title='IR_HIOP' data-ref="IR_HIOP" data-ref-filename="IR_HIOP">IR_HIOP</a> ||</td></tr>
<tr><th id="279">279</th><td>			    (<a class="local col8 ref" href="#98as" title='as' data-ref="98as" data-ref-filename="98as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::curins" title='ASMState::curins' data-use='r' data-ref="ASMState::curins" data-ref-filename="ASMState..curins">curins</a>+<var>1</var> &lt; <a class="local col8 ref" href="#98as" title='as' data-ref="98as" data-ref-filename="98as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::T" title='ASMState::T' data-use='r' data-ref="ASMState::T" data-ref-filename="ASMState..T">T</a>-&gt;<a class="ref field" href="lj_jit.h.html#GCtrace::nins" title='GCtrace::nins' data-ref="GCtrace::nins" data-ref-filename="GCtrace..nins">nins</a> &amp;&amp;</td></tr>
<tr><th id="280">280</th><td>			     <a class="macro" href="lj_asm.c.html#109" title="(&amp;as-&gt;ir[(as-&gt;curins+1)])" data-ref="_M/IR">IR</a>(<a class="local col8 ref" href="#98as" title='as' data-ref="98as" data-ref-filename="98as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::curins" title='ASMState::curins' data-use='r' data-ref="ASMState::curins" data-ref-filename="ASMState..curins">curins</a>+<var>1</var>)-&gt;<a class="ref field" href="lj_ir.h.html#551" title='IRIns::(anonymous struct)::o' data-ref="IRIns::(anonymous)::o" data-ref-filename="IRIns..(anonymous)..o">o</a> == <a class="enum" href="lj_ir.h.html#154" title='IR_HIOP' data-ref="IR_HIOP" data-ref-filename="IR_HIOP">IR_HIOP</a>))) &amp;&amp;</td></tr>
<tr><th id="281">281</th><td>		!((*<a class="local col8 ref" href="#98as" title='as' data-ref="98as" data-ref-filename="98as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a> == <var>0x0f</var> &amp;&amp; (<a class="local col8 ref" href="#98as" title='as' data-ref="98as" data-ref-filename="98as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a>[<var>1</var>] &amp; <var>0xf0</var>) == <a class="enum" href="lj_target_x86.h.html#XI_JCCn" title='XI_JCCn' data-ref="XI_JCCn" data-ref-filename="XI_JCCn">XI_JCCn</a>) ||</td></tr>
<tr><th id="282">282</th><td>		  (*<a class="local col8 ref" href="#98as" title='as' data-ref="98as" data-ref-filename="98as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a> &amp; <var>0xf0</var>) == <a class="enum" href="lj_target_x86.h.html#XI_JCCs" title='XI_JCCs' data-ref="XI_JCCs" data-ref-filename="XI_JCCs">XI_JCCs</a>)) {</td></tr>
<tr><th id="283">283</th><td>    <a class="ref fn" href="#emit_rr" title='emit_rr' data-ref="emit_rr" data-ref-filename="emit_rr">emit_rr</a>(<a class="local col8 ref" href="#98as" title='as' data-ref="98as" data-ref-filename="98as">as</a>, <a class="macro" href="lj_target_x86.h.html#328" title="((x86Op)(0x030000fe + ((XOg_XOR)&lt;&lt;27)))" data-ref="_M/XO_ARITH">XO_ARITH</a>(<a class="enum" href="lj_target_x86.h.html#XOg_XOR" title='XOg_XOR' data-ref="XOg_XOR" data-ref-filename="XOg_XOR">XOg_XOR</a>), <a class="local col9 ref" href="#99r" title='r' data-ref="99r" data-ref-filename="99r">r</a>, <a class="local col9 ref" href="#99r" title='r' data-ref="99r" data-ref-filename="99r">r</a>);</td></tr>
<tr><th id="284">284</th><td>  } <b>else</b> {</td></tr>
<tr><th id="285">285</th><td>    <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col1 decl" id="101p" title='p' data-type='MCode *' data-ref="101p" data-ref-filename="101p">p</dfn> = <a class="local col8 ref" href="#98as" title='as' data-ref="98as" data-ref-filename="98as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a>;</td></tr>
<tr><th id="286">286</th><td>    *(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> *)(<a class="local col1 ref" href="#101p" title='p' data-ref="101p" data-ref-filename="101p">p</a>-<var>4</var>) = <a class="local col0 ref" href="#100i" title='i' data-ref="100i" data-ref-filename="100i">i</a>;</td></tr>
<tr><th id="287">287</th><td>    <a class="local col1 ref" href="#101p" title='p' data-ref="101p" data-ref-filename="101p">p</a>[-<var>5</var>] = (<a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a>)(<a class="enum" href="lj_target_x86.h.html#XI_MOVri" title='XI_MOVri' data-ref="XI_MOVri" data-ref-filename="XI_MOVri">XI_MOVri</a>+(<a class="local col9 ref" href="#99r" title='r' data-ref="99r" data-ref-filename="99r">r</a>&amp;<var>7</var>));</td></tr>
<tr><th id="288">288</th><td>    <a class="local col1 ref" href="#101p" title='p' data-ref="101p" data-ref-filename="101p">p</a> -= <var>5</var>;</td></tr>
<tr><th id="289">289</th><td>    <a class="macro" href="#11" title="{ MCode rex = 0x40 + (((0)&gt;&gt;1)&amp;4) + (((r)&gt;&gt;3)&amp;1); if (rex != 0x40) *--(p) = rex; }" data-ref="_M/REXRB">REXRB</a>(<a class="local col1 ref" href="#101p" title='p' data-ref="101p" data-ref-filename="101p">p</a>, <var>0</var>, <a class="local col9 ref" href="#99r" title='r' data-ref="99r" data-ref-filename="99r">r</a>);</td></tr>
<tr><th id="290">290</th><td>    <a class="local col8 ref" href="#98as" title='as' data-ref="98as" data-ref-filename="98as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='w' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a> = <a class="local col1 ref" href="#101p" title='p' data-ref="101p" data-ref-filename="101p">p</a>;</td></tr>
<tr><th id="291">291</th><td>  }</td></tr>
<tr><th id="292">292</th><td>}</td></tr>
<tr><th id="293">293</th><td></td></tr>
<tr><th id="294">294</th><td><u>#<span data-ppcond="294">if</span> <a class="macro" href="lj_arch.h.html#526" title="1" data-ref="_M/LJ_GC64">LJ_GC64</a></u></td></tr>
<tr><th id="295">295</th><td><u>#define <dfn class="macro" id="_M/dispofs" data-ref="_M/dispofs">dispofs</dfn>(as, k) \</u></td></tr>
<tr><th id="296">296</th><td><u>  ((<a class="typedef" href="../include/stdint.h.html#intptr_t" title='intptr_t' data-type='long' data-ref="intptr_t" data-ref-filename="intptr_t">intptr_t</a>)((<a class="typedef" href="../include/stdint.h.html#uintptr_t" title='uintptr_t' data-type='unsigned long' data-ref="uintptr_t" data-ref-filename="uintptr_t">uintptr_t</a>)(k) - (<a class="typedef" href="../include/stdint.h.html#uintptr_t" title='uintptr_t' data-type='unsigned long' data-ref="uintptr_t" data-ref-filename="uintptr_t">uintptr_t</a>)J2GG(as-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::J" title='ASMState::J' data-use='r' data-ref="ASMState::J" data-ref-filename="ASMState..J">J</a>)-&gt;<a class="ref field" href="lj_dispatch.h.html#GG_State::dispatch" title='GG_State::dispatch' data-ref="GG_State::dispatch" data-ref-filename="GG_State..dispatch">dispatch</a>))</u></td></tr>
<tr><th id="297">297</th><td><u>#define <dfn class="macro" id="_M/mcpofs" data-ref="_M/mcpofs">mcpofs</dfn>(as, k) \</u></td></tr>
<tr><th id="298">298</th><td><u>  ((<a class="typedef" href="../include/stdint.h.html#intptr_t" title='intptr_t' data-type='long' data-ref="intptr_t" data-ref-filename="intptr_t">intptr_t</a>)((<a class="typedef" href="../include/stdint.h.html#uintptr_t" title='uintptr_t' data-type='unsigned long' data-ref="uintptr_t" data-ref-filename="uintptr_t">uintptr_t</a>)(k) - (<a class="typedef" href="../include/stdint.h.html#uintptr_t" title='uintptr_t' data-type='unsigned long' data-ref="uintptr_t" data-ref-filename="uintptr_t">uintptr_t</a>)as-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a>))</u></td></tr>
<tr><th id="299">299</th><td><u>#define <dfn class="macro" id="_M/mctopofs" data-ref="_M/mctopofs">mctopofs</dfn>(as, k) \</u></td></tr>
<tr><th id="300">300</th><td><u>  ((<a class="typedef" href="../include/stdint.h.html#intptr_t" title='intptr_t' data-type='long' data-ref="intptr_t" data-ref-filename="intptr_t">intptr_t</a>)((<a class="typedef" href="../include/stdint.h.html#uintptr_t" title='uintptr_t' data-type='unsigned long' data-ref="uintptr_t" data-ref-filename="uintptr_t">uintptr_t</a>)(k) - (<a class="typedef" href="../include/stdint.h.html#uintptr_t" title='uintptr_t' data-type='unsigned long' data-ref="uintptr_t" data-ref-filename="uintptr_t">uintptr_t</a>)as-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mctop" title='ASMState::mctop' data-use='r' data-ref="ASMState::mctop" data-ref-filename="ASMState..mctop">mctop</a>))</u></td></tr>
<tr><th id="301">301</th><td><i>/* mov r, addr */</i></td></tr>
<tr><th id="302">302</th><td><u>#define <dfn class="macro" id="_M/emit_loada" data-ref="_M/emit_loada">emit_loada</dfn>(as, r, addr) \</u></td></tr>
<tr><th id="303">303</th><td><u>  emit_loadu64(as, (r), (uintptr_t)(addr))</u></td></tr>
<tr><th id="304">304</th><td><u>#<span data-ppcond="294">else</span></u></td></tr>
<tr><th id="305">305</th><td><i>/* mov r, addr */</i></td></tr>
<tr><th id="306">306</th><td><u>#define emit_loada(as, r, addr) \</u></td></tr>
<tr><th id="307">307</th><td><u>  emit_loadi(as, (r), ptr2addr((addr)))</u></td></tr>
<tr><th id="308">308</th><td><u>#<span data-ppcond="294">endif</span></u></td></tr>
<tr><th id="309">309</th><td></td></tr>
<tr><th id="310">310</th><td><u>#<span data-ppcond="310">if</span> <a class="macro" href="lj_arch.h.html#600" title="1" data-ref="_M/LJ_64">LJ_64</a></u></td></tr>
<tr><th id="311">311</th><td><i>/* mov r, imm64 or shorter 32 bit extended load. */</i></td></tr>
<tr><th id="312">312</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_loadu64" title='emit_loadu64' data-ref="emit_loadu64" data-ref-filename="emit_loadu64">emit_loadu64</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col3 decl" id="103as" title='as' data-type='ASMState *' data-ref="103as" data-ref-filename="103as">as</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col4 decl" id="104r" title='r' data-type='Reg' data-ref="104r" data-ref-filename="104r">r</dfn>, <a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-uintn.h.html#uint64_t" title='uint64_t' data-type='__uint64_t' data-ref="uint64_t" data-ref-filename="uint64_t">uint64_t</a> <dfn class="local col5 decl" id="105u64" title='u64' data-type='uint64_t' data-ref="105u64" data-ref-filename="105u64">u64</dfn>)</td></tr>
<tr><th id="313">313</th><td>{</td></tr>
<tr><th id="314">314</th><td>  <b>if</b> (<a class="macro" href="lj_def.h.html#106" title="((u64) == (uint32_t)(u64))" data-ref="_M/checku32">checku32</a>(<a class="local col5 ref" href="#105u64" title='u64' data-ref="105u64" data-ref-filename="105u64">u64</a>)) {  <i>/* 32 bit load clears upper 32 bits. */</i></td></tr>
<tr><th id="315">315</th><td>    <a class="ref fn" href="#emit_loadi" title='emit_loadi' data-ref="emit_loadi" data-ref-filename="emit_loadi">emit_loadi</a>(<a class="local col3 ref" href="#103as" title='as' data-ref="103as" data-ref-filename="103as">as</a>, <a class="local col4 ref" href="#104r" title='r' data-ref="104r" data-ref-filename="104r">r</a>, (<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a>)<a class="local col5 ref" href="#105u64" title='u64' data-ref="105u64" data-ref-filename="105u64">u64</a>);</td></tr>
<tr><th id="316">316</th><td>  } <b>else</b> <b>if</b> (<a class="macro" href="lj_def.h.html#105" title="(((int64_t)u64) == (int32_t)((int64_t)u64))" data-ref="_M/checki32">checki32</a>((<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int64_t" title='int64_t' data-type='__int64_t' data-ref="int64_t" data-ref-filename="int64_t">int64_t</a>)<a class="local col5 ref" href="#105u64" title='u64' data-ref="105u64" data-ref-filename="105u64">u64</a>)) {  <i>/* Sign-extended 32 bit load. */</i></td></tr>
<tr><th id="317">317</th><td>    <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col6 decl" id="106p" title='p' data-type='MCode *' data-ref="106p" data-ref-filename="106p">p</dfn> = <a class="local col3 ref" href="#103as" title='as' data-ref="103as" data-ref-filename="103as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a>;</td></tr>
<tr><th id="318">318</th><td>    *(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> *)(<a class="local col6 ref" href="#106p" title='p' data-ref="106p" data-ref-filename="106p">p</a>-<var>4</var>) = (<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a>)<a class="local col5 ref" href="#105u64" title='u64' data-ref="105u64" data-ref-filename="105u64">u64</a>;</td></tr>
<tr><th id="319">319</th><td>    <a class="local col3 ref" href="#103as" title='as' data-ref="103as" data-ref-filename="103as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='w' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a> = <a class="macro" href="#74" title="(p[(-4)-1] = ((MCode)(((XM_REG))+(((((0x200|0x080000)))&amp;7)&lt;&lt;3)+(((r))&amp;7))), emit_op((XO_MOVmi), ((0x200|0x080000)), (r), 0, (p), (-4)))" data-ref="_M/emit_opm">emit_opm</a>(<a class="enum" href="lj_target_x86.h.html#XO_MOVmi" title='XO_MOVmi' data-ref="XO_MOVmi" data-ref-filename="XO_MOVmi">XO_MOVmi</a>, <a class="enum" href="lj_target_x86.h.html#XM_REG" title='XM_REG' data-ref="XM_REG" data-ref-filename="XM_REG">XM_REG</a>, <a class="macro" href="#15" title="(0x200|0x080000)" data-ref="_M/REX_64">REX_64</a>, <a class="local col4 ref" href="#104r" title='r' data-ref="104r" data-ref-filename="104r">r</a>, <a class="local col6 ref" href="#106p" title='p' data-ref="106p" data-ref-filename="106p">p</a>, -<var>4</var>);</td></tr>
<tr><th id="320">320</th><td><u>#<span data-ppcond="320">if</span> <a class="macro" href="lj_arch.h.html#526" title="1" data-ref="_M/LJ_GC64">LJ_GC64</a></u></td></tr>
<tr><th id="321">321</th><td>  } <b>else</b> <b>if</b> (<a class="macro" href="lj_def.h.html#105" title="((((intptr_t)((uintptr_t)(u64) - (uintptr_t)((GG_State *)((char *)(as-&gt;J) - ((int)__builtin_offsetof(GG_State, J))))-&gt;dispatch))) == (int32_t)(((intptr_t)((uintptr_t)(u64) - (uintptr_t)((GG_State *)((char *)(as-&gt;J) - ((int)__builtin_offsetof(GG_State, J))))-&gt;dispatch))))" data-ref="_M/checki32">checki32</a>(<a class="macro" href="#295" title="((intptr_t)((uintptr_t)(u64) - (uintptr_t)((GG_State *)((char *)(as-&gt;J) - ((int)__builtin_offsetof(GG_State, J))))-&gt;dispatch))" data-ref="_M/dispofs">dispofs</a>(<a class="local col3 ref" href="#103as" title='as' data-ref="103as" data-ref-filename="103as">as</a>, <a class="local col5 ref" href="#105u64" title='u64' data-ref="105u64" data-ref-filename="105u64">u64</a>))) {</td></tr>
<tr><th id="322">322</th><td>    <a class="ref fn" href="#emit_rmro" title='emit_rmro' data-ref="emit_rmro" data-ref-filename="emit_rmro">emit_rmro</a>(<a class="local col3 ref" href="#103as" title='as' data-ref="103as" data-ref-filename="103as">as</a>, <a class="enum" href="lj_target_x86.h.html#XO_LEA" title='XO_LEA' data-ref="XO_LEA" data-ref-filename="XO_LEA">XO_LEA</a>, <a class="local col4 ref" href="#104r" title='r' data-ref="104r" data-ref-filename="104r">r</a>|<a class="macro" href="#15" title="(0x200|0x080000)" data-ref="_M/REX_64">REX_64</a>, <a class="enum" href="lj_target_x86.h.html#RID_DISPATCH" title='RID_DISPATCH' data-ref="RID_DISPATCH" data-ref-filename="RID_DISPATCH">RID_DISPATCH</a>, (<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a>)<a class="macro" href="#295" title="((intptr_t)((uintptr_t)(u64) - (uintptr_t)((GG_State *)((char *)(as-&gt;J) - ((int)__builtin_offsetof(GG_State, J))))-&gt;dispatch))" data-ref="_M/dispofs">dispofs</a>(<a class="local col3 ref" href="#103as" title='as' data-ref="103as" data-ref-filename="103as">as</a>, <a class="local col5 ref" href="#105u64" title='u64' data-ref="105u64" data-ref-filename="105u64">u64</a>));</td></tr>
<tr><th id="323">323</th><td>  } <b>else</b> <b>if</b> (<a class="macro" href="lj_def.h.html#105" title="((((intptr_t)((uintptr_t)(u64) - (uintptr_t)as-&gt;mcp))) == (int32_t)(((intptr_t)((uintptr_t)(u64) - (uintptr_t)as-&gt;mcp))))" data-ref="_M/checki32">checki32</a>(<a class="macro" href="#297" title="((intptr_t)((uintptr_t)(u64) - (uintptr_t)as-&gt;mcp))" data-ref="_M/mcpofs">mcpofs</a>(<a class="local col3 ref" href="#103as" title='as' data-ref="103as" data-ref-filename="103as">as</a>, <a class="local col5 ref" href="#105u64" title='u64' data-ref="105u64" data-ref-filename="105u64">u64</a>)) &amp;&amp; <a class="macro" href="lj_def.h.html#105" title="((((intptr_t)((uintptr_t)(u64) - (uintptr_t)as-&gt;mctop))) == (int32_t)(((intptr_t)((uintptr_t)(u64) - (uintptr_t)as-&gt;mctop))))" data-ref="_M/checki32">checki32</a>(<a class="macro" href="#299" title="((intptr_t)((uintptr_t)(u64) - (uintptr_t)as-&gt;mctop))" data-ref="_M/mctopofs">mctopofs</a>(<a class="local col3 ref" href="#103as" title='as' data-ref="103as" data-ref-filename="103as">as</a>, <a class="local col5 ref" href="#105u64" title='u64' data-ref="105u64" data-ref-filename="105u64">u64</a>))) {</td></tr>
<tr><th id="324">324</th><td>    <i>/* Since as-&gt;realign assumes the code size doesn't change, check</i></td></tr>
<tr><th id="325">325</th><td><i>    ** RIP-relative addressing reachability for both as-&gt;mcp and as-&gt;mctop.</i></td></tr>
<tr><th id="326">326</th><td><i>    */</i></td></tr>
<tr><th id="327">327</th><td>    <a class="ref fn" href="#emit_rmro" title='emit_rmro' data-ref="emit_rmro" data-ref-filename="emit_rmro">emit_rmro</a>(<a class="local col3 ref" href="#103as" title='as' data-ref="103as" data-ref-filename="103as">as</a>, <a class="enum" href="lj_target_x86.h.html#XO_LEA" title='XO_LEA' data-ref="XO_LEA" data-ref-filename="XO_LEA">XO_LEA</a>, <a class="local col4 ref" href="#104r" title='r' data-ref="104r" data-ref-filename="104r">r</a>|<a class="macro" href="#15" title="(0x200|0x080000)" data-ref="_M/REX_64">REX_64</a>, <a class="enum" href="lj_target_x86.h.html#RID_RIP" title='RID_RIP' data-ref="RID_RIP" data-ref-filename="RID_RIP">RID_RIP</a>, (<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a>)<a class="macro" href="#297" title="((intptr_t)((uintptr_t)(u64) - (uintptr_t)as-&gt;mcp))" data-ref="_M/mcpofs">mcpofs</a>(<a class="local col3 ref" href="#103as" title='as' data-ref="103as" data-ref-filename="103as">as</a>, <a class="local col5 ref" href="#105u64" title='u64' data-ref="105u64" data-ref-filename="105u64">u64</a>));</td></tr>
<tr><th id="328">328</th><td><u>#<span data-ppcond="320">endif</span></u></td></tr>
<tr><th id="329">329</th><td>  } <b>else</b> {  <i>/* Full-size 64 bit load. */</i></td></tr>
<tr><th id="330">330</th><td>    <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col7 decl" id="107p" title='p' data-type='MCode *' data-ref="107p" data-ref-filename="107p">p</dfn> = <a class="local col3 ref" href="#103as" title='as' data-ref="103as" data-ref-filename="103as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a>;</td></tr>
<tr><th id="331">331</th><td>    *(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-uintn.h.html#uint64_t" title='uint64_t' data-type='__uint64_t' data-ref="uint64_t" data-ref-filename="uint64_t">uint64_t</a> *)(<a class="local col7 ref" href="#107p" title='p' data-ref="107p" data-ref-filename="107p">p</a>-<var>8</var>) = <a class="local col5 ref" href="#105u64" title='u64' data-ref="105u64" data-ref-filename="105u64">u64</a>;</td></tr>
<tr><th id="332">332</th><td>    <a class="local col7 ref" href="#107p" title='p' data-ref="107p" data-ref-filename="107p">p</a>[-<var>9</var>] = (<a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a>)(<a class="enum" href="lj_target_x86.h.html#XI_MOVri" title='XI_MOVri' data-ref="XI_MOVri" data-ref-filename="XI_MOVri">XI_MOVri</a>+(<a class="local col4 ref" href="#104r" title='r' data-ref="104r" data-ref-filename="104r">r</a>&amp;<var>7</var>));</td></tr>
<tr><th id="333">333</th><td>    <a class="local col7 ref" href="#107p" title='p' data-ref="107p" data-ref-filename="107p">p</a>[-<var>10</var>] = <var>0x48</var> + ((<a class="local col4 ref" href="#104r" title='r' data-ref="104r" data-ref-filename="104r">r</a>&gt;&gt;<var>3</var>)&amp;<var>1</var>);</td></tr>
<tr><th id="334">334</th><td>    <a class="local col7 ref" href="#107p" title='p' data-ref="107p" data-ref-filename="107p">p</a> -= <var>10</var>;</td></tr>
<tr><th id="335">335</th><td>    <a class="local col3 ref" href="#103as" title='as' data-ref="103as" data-ref-filename="103as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='w' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a> = <a class="local col7 ref" href="#107p" title='p' data-ref="107p" data-ref-filename="107p">p</a>;</td></tr>
<tr><th id="336">336</th><td>  }</td></tr>
<tr><th id="337">337</th><td>}</td></tr>
<tr><th id="338">338</th><td><u>#<span data-ppcond="310">endif</span></u></td></tr>
<tr><th id="339">339</th><td></td></tr>
<tr><th id="340">340</th><td><i>/* op r, [addr] */</i></td></tr>
<tr><th id="341">341</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_rma" title='emit_rma' data-ref="emit_rma" data-ref-filename="emit_rma">emit_rma</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col8 decl" id="108as" title='as' data-type='ASMState *' data-ref="108as" data-ref-filename="108as">as</dfn>, <a class="typedef" href="lj_target_x86.h.html#x86Op" title='x86Op' data-type='enum x86Op' data-ref="x86Op" data-ref-filename="x86Op">x86Op</a> <dfn class="local col9 decl" id="109xo" title='xo' data-type='x86Op' data-ref="109xo" data-ref-filename="109xo">xo</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col0 decl" id="110rr" title='rr' data-type='Reg' data-ref="110rr" data-ref-filename="110rr">rr</dfn>, <em>const</em> <em>void</em> *<dfn class="local col1 decl" id="111addr" title='addr' data-type='const void *' data-ref="111addr" data-ref-filename="111addr">addr</dfn>)</td></tr>
<tr><th id="342">342</th><td>{</td></tr>
<tr><th id="343">343</th><td><u>#<span data-ppcond="343">if</span> <a class="macro" href="lj_arch.h.html#526" title="1" data-ref="_M/LJ_GC64">LJ_GC64</a></u></td></tr>
<tr><th id="344">344</th><td>  <b>if</b> (<a class="macro" href="lj_def.h.html#105" title="((((intptr_t)((uintptr_t)(addr) - (uintptr_t)((GG_State *)((char *)(as-&gt;J) - ((int)__builtin_offsetof(GG_State, J))))-&gt;dispatch))) == (int32_t)(((intptr_t)((uintptr_t)(addr) - (uintptr_t)((GG_State *)((char *)(as-&gt;J) - ((int)__builtin_offsetof(GG_State, J))))-&gt;dispatch))))" data-ref="_M/checki32">checki32</a>(<a class="macro" href="#295" title="((intptr_t)((uintptr_t)(addr) - (uintptr_t)((GG_State *)((char *)(as-&gt;J) - ((int)__builtin_offsetof(GG_State, J))))-&gt;dispatch))" data-ref="_M/dispofs">dispofs</a>(<a class="local col8 ref" href="#108as" title='as' data-ref="108as" data-ref-filename="108as">as</a>, <a class="local col1 ref" href="#111addr" title='addr' data-ref="111addr" data-ref-filename="111addr">addr</a>))) {</td></tr>
<tr><th id="345">345</th><td>    <a class="ref fn" href="#emit_rmro" title='emit_rmro' data-ref="emit_rmro" data-ref-filename="emit_rmro">emit_rmro</a>(<a class="local col8 ref" href="#108as" title='as' data-ref="108as" data-ref-filename="108as">as</a>, <a class="local col9 ref" href="#109xo" title='xo' data-ref="109xo" data-ref-filename="109xo">xo</a>, <a class="local col0 ref" href="#110rr" title='rr' data-ref="110rr" data-ref-filename="110rr">rr</a>, <a class="enum" href="lj_target_x86.h.html#RID_DISPATCH" title='RID_DISPATCH' data-ref="RID_DISPATCH" data-ref-filename="RID_DISPATCH">RID_DISPATCH</a>, (<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a>)<a class="macro" href="#295" title="((intptr_t)((uintptr_t)(addr) - (uintptr_t)((GG_State *)((char *)(as-&gt;J) - ((int)__builtin_offsetof(GG_State, J))))-&gt;dispatch))" data-ref="_M/dispofs">dispofs</a>(<a class="local col8 ref" href="#108as" title='as' data-ref="108as" data-ref-filename="108as">as</a>, <a class="local col1 ref" href="#111addr" title='addr' data-ref="111addr" data-ref-filename="111addr">addr</a>));</td></tr>
<tr><th id="346">346</th><td>  } <b>else</b> <b>if</b> (<a class="macro" href="lj_def.h.html#105" title="((((intptr_t)((uintptr_t)(addr) - (uintptr_t)as-&gt;mcp))) == (int32_t)(((intptr_t)((uintptr_t)(addr) - (uintptr_t)as-&gt;mcp))))" data-ref="_M/checki32">checki32</a>(<a class="macro" href="#297" title="((intptr_t)((uintptr_t)(addr) - (uintptr_t)as-&gt;mcp))" data-ref="_M/mcpofs">mcpofs</a>(<a class="local col8 ref" href="#108as" title='as' data-ref="108as" data-ref-filename="108as">as</a>, <a class="local col1 ref" href="#111addr" title='addr' data-ref="111addr" data-ref-filename="111addr">addr</a>)) &amp;&amp; <a class="macro" href="lj_def.h.html#105" title="((((intptr_t)((uintptr_t)(addr) - (uintptr_t)as-&gt;mctop))) == (int32_t)(((intptr_t)((uintptr_t)(addr) - (uintptr_t)as-&gt;mctop))))" data-ref="_M/checki32">checki32</a>(<a class="macro" href="#299" title="((intptr_t)((uintptr_t)(addr) - (uintptr_t)as-&gt;mctop))" data-ref="_M/mctopofs">mctopofs</a>(<a class="local col8 ref" href="#108as" title='as' data-ref="108as" data-ref-filename="108as">as</a>, <a class="local col1 ref" href="#111addr" title='addr' data-ref="111addr" data-ref-filename="111addr">addr</a>))) {</td></tr>
<tr><th id="347">347</th><td>    <a class="ref fn" href="#emit_rmro" title='emit_rmro' data-ref="emit_rmro" data-ref-filename="emit_rmro">emit_rmro</a>(<a class="local col8 ref" href="#108as" title='as' data-ref="108as" data-ref-filename="108as">as</a>, <a class="local col9 ref" href="#109xo" title='xo' data-ref="109xo" data-ref-filename="109xo">xo</a>, <a class="local col0 ref" href="#110rr" title='rr' data-ref="110rr" data-ref-filename="110rr">rr</a>, <a class="enum" href="lj_target_x86.h.html#RID_RIP" title='RID_RIP' data-ref="RID_RIP" data-ref-filename="RID_RIP">RID_RIP</a>, (<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a>)<a class="macro" href="#297" title="((intptr_t)((uintptr_t)(addr) - (uintptr_t)as-&gt;mcp))" data-ref="_M/mcpofs">mcpofs</a>(<a class="local col8 ref" href="#108as" title='as' data-ref="108as" data-ref-filename="108as">as</a>, <a class="local col1 ref" href="#111addr" title='addr' data-ref="111addr" data-ref-filename="111addr">addr</a>));</td></tr>
<tr><th id="348">348</th><td>  } <b>else</b> <b>if</b> (!<a class="macro" href="lj_def.h.html#105" title="(((intptr_t)addr) == (int32_t)((intptr_t)addr))" data-ref="_M/checki32">checki32</a>((<a class="typedef" href="../include/stdint.h.html#intptr_t" title='intptr_t' data-type='long' data-ref="intptr_t" data-ref-filename="intptr_t">intptr_t</a>)<a class="local col1 ref" href="#111addr" title='addr' data-ref="111addr" data-ref-filename="111addr">addr</a>)) {</td></tr>
<tr><th id="349">349</th><td>    <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col2 decl" id="112ra" title='ra' data-type='Reg' data-ref="112ra" data-ref-filename="112ra">ra</dfn> = (<a class="local col0 ref" href="#110rr" title='rr' data-ref="110rr" data-ref-filename="110rr">rr</a> &amp; <var>15</var>);</td></tr>
<tr><th id="350">350</th><td>    <b>if</b> (<a class="local col9 ref" href="#109xo" title='xo' data-ref="109xo" data-ref-filename="109xo">xo</a> != <a class="enum" href="lj_target_x86.h.html#XO_MOV" title='XO_MOV' data-ref="XO_MOV" data-ref-filename="XO_MOV">XO_MOV</a>) {</td></tr>
<tr><th id="351">351</th><td>      <i>/* We can't allocate a register here. Use and restore DISPATCH. Ugly. */</i></td></tr>
<tr><th id="352">352</th><td>      <a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-uintn.h.html#uint64_t" title='uint64_t' data-type='__uint64_t' data-ref="uint64_t" data-ref-filename="uint64_t">uint64_t</a> <dfn class="local col3 decl" id="113dispaddr" title='dispaddr' data-type='uint64_t' data-ref="113dispaddr" data-ref-filename="113dispaddr">dispaddr</dfn> = (<a class="typedef" href="../include/stdint.h.html#uintptr_t" title='uintptr_t' data-type='unsigned long' data-ref="uintptr_t" data-ref-filename="uintptr_t">uintptr_t</a>)<a class="macro" href="lj_dispatch.h.html#113" title="((GG_State *)((char *)(as-&gt;J) - ((int)__builtin_offsetof(GG_State, J))))" data-ref="_M/J2GG">J2GG</a>(<a class="local col8 ref" href="#108as" title='as' data-ref="108as" data-ref-filename="108as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::J" title='ASMState::J' data-use='r' data-ref="ASMState::J" data-ref-filename="ASMState..J">J</a>)-&gt;<a class="ref field" href="lj_dispatch.h.html#GG_State::dispatch" title='GG_State::dispatch' data-ref="GG_State::dispatch" data-ref-filename="GG_State..dispatch">dispatch</a>;</td></tr>
<tr><th id="353">353</th><td>      <a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-uintn.h.html#uint8_t" title='uint8_t' data-type='__uint8_t' data-ref="uint8_t" data-ref-filename="uint8_t">uint8_t</a> <dfn class="local col4 decl" id="114i8" title='i8' data-type='uint8_t' data-ref="114i8" data-ref-filename="114i8">i8</dfn> = <a class="local col9 ref" href="#109xo" title='xo' data-ref="109xo" data-ref-filename="109xo">xo</a> == <a class="enum" href="lj_target_x86.h.html#XO_GROUP3b" title='XO_GROUP3b' data-ref="XO_GROUP3b" data-ref-filename="XO_GROUP3b">XO_GROUP3b</a> ? *<a class="local col8 ref" href="#108as" title='as' data-ref="108as" data-ref-filename="108as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='w' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a>++ : <var>0</var>;</td></tr>
<tr><th id="354">354</th><td>      <a class="local col2 ref" href="#112ra" title='ra' data-ref="112ra" data-ref-filename="112ra">ra</a> = <a class="enum" href="lj_target_x86.h.html#RID_DISPATCH" title='RID_DISPATCH' data-ref="RID_DISPATCH" data-ref-filename="RID_DISPATCH">RID_DISPATCH</a>;</td></tr>
<tr><th id="355">355</th><td>      <b>if</b> (<a class="macro" href="lj_def.h.html#106" title="((dispaddr) == (uint32_t)(dispaddr))" data-ref="_M/checku32">checku32</a>(<a class="local col3 ref" href="#113dispaddr" title='dispaddr' data-ref="113dispaddr" data-ref-filename="113dispaddr">dispaddr</a>)) {</td></tr>
<tr><th id="356">356</th><td>	<a class="ref fn" href="#emit_loadi" title='emit_loadi' data-ref="emit_loadi" data-ref-filename="emit_loadi">emit_loadi</a>(<a class="local col8 ref" href="#108as" title='as' data-ref="108as" data-ref-filename="108as">as</a>, <a class="local col2 ref" href="#112ra" title='ra' data-ref="112ra" data-ref-filename="112ra">ra</a>, (<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a>)<a class="local col3 ref" href="#113dispaddr" title='dispaddr' data-ref="113dispaddr" data-ref-filename="113dispaddr">dispaddr</a>);</td></tr>
<tr><th id="357">357</th><td>      } <b>else</b> {  <i>/* Full-size 64 bit load. */</i></td></tr>
<tr><th id="358">358</th><td>	<a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col5 decl" id="115p" title='p' data-type='MCode *' data-ref="115p" data-ref-filename="115p">p</dfn> = <a class="local col8 ref" href="#108as" title='as' data-ref="108as" data-ref-filename="108as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a>;</td></tr>
<tr><th id="359">359</th><td>	*(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-uintn.h.html#uint64_t" title='uint64_t' data-type='__uint64_t' data-ref="uint64_t" data-ref-filename="uint64_t">uint64_t</a> *)(<a class="local col5 ref" href="#115p" title='p' data-ref="115p" data-ref-filename="115p">p</a>-<var>8</var>) = <a class="local col3 ref" href="#113dispaddr" title='dispaddr' data-ref="113dispaddr" data-ref-filename="113dispaddr">dispaddr</a>;</td></tr>
<tr><th id="360">360</th><td>	<a class="local col5 ref" href="#115p" title='p' data-ref="115p" data-ref-filename="115p">p</a>[-<var>9</var>] = (<a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a>)(<a class="enum" href="lj_target_x86.h.html#XI_MOVri" title='XI_MOVri' data-ref="XI_MOVri" data-ref-filename="XI_MOVri">XI_MOVri</a>+(<a class="local col2 ref" href="#112ra" title='ra' data-ref="112ra" data-ref-filename="112ra">ra</a>&amp;<var>7</var>));</td></tr>
<tr><th id="361">361</th><td>	<a class="local col5 ref" href="#115p" title='p' data-ref="115p" data-ref-filename="115p">p</a>[-<var>10</var>] = <var>0x48</var> + ((<a class="local col2 ref" href="#112ra" title='ra' data-ref="112ra" data-ref-filename="112ra">ra</a>&gt;&gt;<var>3</var>)&amp;<var>1</var>);</td></tr>
<tr><th id="362">362</th><td>	<a class="local col5 ref" href="#115p" title='p' data-ref="115p" data-ref-filename="115p">p</a> -= <var>10</var>;</td></tr>
<tr><th id="363">363</th><td>	<a class="local col8 ref" href="#108as" title='as' data-ref="108as" data-ref-filename="108as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='w' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a> = <a class="local col5 ref" href="#115p" title='p' data-ref="115p" data-ref-filename="115p">p</a>;</td></tr>
<tr><th id="364">364</th><td>      }</td></tr>
<tr><th id="365">365</th><td>      <b>if</b> (<a class="local col9 ref" href="#109xo" title='xo' data-ref="109xo" data-ref-filename="109xo">xo</a> == <a class="enum" href="lj_target_x86.h.html#XO_GROUP3b" title='XO_GROUP3b' data-ref="XO_GROUP3b" data-ref-filename="XO_GROUP3b">XO_GROUP3b</a>) <a class="macro" href="#29" title="(*--as-&gt;mcp = (MCode)(i8))" data-ref="_M/emit_i8">emit_i8</a>(<a class="local col8 ref" href="#108as" title='as' data-ref="108as" data-ref-filename="108as">as</a>, <a class="local col4 ref" href="#114i8" title='i8' data-ref="114i8" data-ref-filename="114i8">i8</a>);</td></tr>
<tr><th id="366">366</th><td>    }</td></tr>
<tr><th id="367">367</th><td>    <a class="ref fn" href="#emit_rmro" title='emit_rmro' data-ref="emit_rmro" data-ref-filename="emit_rmro">emit_rmro</a>(<a class="local col8 ref" href="#108as" title='as' data-ref="108as" data-ref-filename="108as">as</a>, <a class="local col9 ref" href="#109xo" title='xo' data-ref="109xo" data-ref-filename="109xo">xo</a>, <a class="local col0 ref" href="#110rr" title='rr' data-ref="110rr" data-ref-filename="110rr">rr</a>, <a class="local col2 ref" href="#112ra" title='ra' data-ref="112ra" data-ref-filename="112ra">ra</a>, <var>0</var>);</td></tr>
<tr><th id="368">368</th><td>    <a class="ref fn" href="#emit_loadu64" title='emit_loadu64' data-ref="emit_loadu64" data-ref-filename="emit_loadu64">emit_loadu64</a>(<a class="local col8 ref" href="#108as" title='as' data-ref="108as" data-ref-filename="108as">as</a>, <a class="local col2 ref" href="#112ra" title='ra' data-ref="112ra" data-ref-filename="112ra">ra</a>, (<a class="typedef" href="../include/stdint.h.html#uintptr_t" title='uintptr_t' data-type='unsigned long' data-ref="uintptr_t" data-ref-filename="uintptr_t">uintptr_t</a>)<a class="local col1 ref" href="#111addr" title='addr' data-ref="111addr" data-ref-filename="111addr">addr</a>);</td></tr>
<tr><th id="369">369</th><td>  } <b>else</b></td></tr>
<tr><th id="370">370</th><td><u>#<span data-ppcond="343">endif</span></u></td></tr>
<tr><th id="371">371</th><td>  {</td></tr>
<tr><th id="372">372</th><td>    <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col6 decl" id="116p" title='p' data-type='MCode *' data-ref="116p" data-ref-filename="116p">p</dfn> = <a class="local col8 ref" href="#108as" title='as' data-ref="108as" data-ref-filename="108as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a>;</td></tr>
<tr><th id="373">373</th><td>    *(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> *)(<a class="local col6 ref" href="#116p" title='p' data-ref="116p" data-ref-filename="116p">p</a>-<var>4</var>) = <a class="macro" href="#99" title="(((int32_t)(intptr_t)(void *)((addr))))" data-ref="_M/ptr2addr">ptr2addr</a>(<a class="local col1 ref" href="#111addr" title='addr' data-ref="111addr" data-ref-filename="111addr">addr</a>);</td></tr>
<tr><th id="374">374</th><td><u>#<span data-ppcond="374">if</span> <a class="macro" href="lj_arch.h.html#600" title="1" data-ref="_M/LJ_64">LJ_64</a></u></td></tr>
<tr><th id="375">375</th><td>    <a class="local col6 ref" href="#116p" title='p' data-ref="116p" data-ref-filename="116p">p</a>[-<var>5</var>] = <a class="macro" href="#8" title="((MCode)((XM_SCALE1)+(((RID_ESP)&amp;7)&lt;&lt;3)+((RID_EBP)&amp;7)))" data-ref="_M/MODRM">MODRM</a>(<a class="enum" href="lj_target_x86.h.html#XM_SCALE1" title='XM_SCALE1' data-ref="XM_SCALE1" data-ref-filename="XM_SCALE1">XM_SCALE1</a>, <a class="enum" href="lj_target_x86.h.html#30" title='RID_ESP' data-ref="RID_ESP" data-ref-filename="RID_ESP">RID_ESP</a>, <a class="enum" href="lj_target_x86.h.html#30" title='RID_EBP' data-ref="RID_EBP" data-ref-filename="RID_EBP">RID_EBP</a>);</td></tr>
<tr><th id="376">376</th><td>    <a class="local col8 ref" href="#108as" title='as' data-ref="108as" data-ref-filename="108as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='w' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a> = <a class="macro" href="#74" title="(p[(-5)-1] = ((MCode)(((XM_OFS0))+((((rr))&amp;7)&lt;&lt;3)+(((RID_ESP))&amp;7))), emit_op((xo), (rr), (RID_ESP), 0, (p), (-5)))" data-ref="_M/emit_opm">emit_opm</a>(<a class="local col9 ref" href="#109xo" title='xo' data-ref="109xo" data-ref-filename="109xo">xo</a>, <a class="enum" href="lj_target_x86.h.html#XM_OFS0" title='XM_OFS0' data-ref="XM_OFS0" data-ref-filename="XM_OFS0">XM_OFS0</a>, <a class="local col0 ref" href="#110rr" title='rr' data-ref="110rr" data-ref-filename="110rr">rr</a>, <a class="enum" href="lj_target_x86.h.html#30" title='RID_ESP' data-ref="RID_ESP" data-ref-filename="RID_ESP">RID_ESP</a>, <a class="local col6 ref" href="#116p" title='p' data-ref="116p" data-ref-filename="116p">p</a>, -<var>5</var>);</td></tr>
<tr><th id="377">377</th><td><u>#<span data-ppcond="374">else</span></u></td></tr>
<tr><th id="378">378</th><td>    as-&gt;mcp = emit_opm(xo, XM_OFS0, rr, RID_EBP, p, -<var>4</var>);</td></tr>
<tr><th id="379">379</th><td><u>#<span data-ppcond="374">endif</span></u></td></tr>
<tr><th id="380">380</th><td>  }</td></tr>
<tr><th id="381">381</th><td>}</td></tr>
<tr><th id="382">382</th><td></td></tr>
<tr><th id="383">383</th><td><i>/* Load 64 bit IR constant into register. */</i></td></tr>
<tr><th id="384">384</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_loadk64" title='emit_loadk64' data-ref="emit_loadk64" data-ref-filename="emit_loadk64">emit_loadk64</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col7 decl" id="117as" title='as' data-type='ASMState *' data-ref="117as" data-ref-filename="117as">as</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col8 decl" id="118r" title='r' data-type='Reg' data-ref="118r" data-ref-filename="118r">r</dfn>, <a class="typedef" href="lj_ir.h.html#IRIns" title='IRIns' data-type='union IRIns' data-ref="IRIns" data-ref-filename="IRIns">IRIns</a> *<dfn class="local col9 decl" id="119ir" title='ir' data-type='IRIns *' data-ref="119ir" data-ref-filename="119ir">ir</dfn>)</td></tr>
<tr><th id="385">385</th><td>{</td></tr>
<tr><th id="386">386</th><td>  <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col0 decl" id="120r64" title='r64' data-type='Reg' data-ref="120r64" data-ref-filename="120r64">r64</dfn>;</td></tr>
<tr><th id="387">387</th><td>  <a class="typedef" href="lj_target_x86.h.html#x86Op" title='x86Op' data-type='enum x86Op' data-ref="x86Op" data-ref-filename="x86Op">x86Op</a> <dfn class="local col1 decl" id="121xo" title='xo' data-type='x86Op' data-ref="121xo" data-ref-filename="121xo">xo</dfn>;</td></tr>
<tr><th id="388">388</th><td>  <em>const</em> <a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-uintn.h.html#uint64_t" title='uint64_t' data-type='__uint64_t' data-ref="uint64_t" data-ref-filename="uint64_t">uint64_t</a> *<dfn class="local col2 decl" id="122k" title='k' data-type='const uint64_t *' data-ref="122k" data-ref-filename="122k">k</dfn> = &amp;<a class="macro" href="lj_ir.h.html#578" title="(&amp;(ir)[1].tv)" data-ref="_M/ir_k64">ir_k64</a>(<a class="local col9 ref" href="#119ir" title='ir' data-ref="119ir" data-ref-filename="119ir">ir</a>)-&gt;<a class="ref field" href="lj_obj.h.html#TValue::u64" title='TValue::u64' data-ref="TValue::u64" data-ref-filename="TValue..u64">u64</a>;</td></tr>
<tr><th id="389">389</th><td>  <b>if</b> (<a class="macro" href="lj_target.h.html#68" title="((int)((((((((RegSet)1) &lt;&lt; ((RID_MAX_FPR)-(RID_MIN_FPR)))-1) &lt;&lt; (RID_MIN_FPR)))) &gt;&gt; (r)) &amp; 1)" data-ref="_M/rset_test">rset_test</a>(<a class="macro" href="lj_target_x86.h.html#71" title="((((((RegSet)1) &lt;&lt; ((RID_MAX_FPR)-(RID_MIN_FPR)))-1) &lt;&lt; (RID_MIN_FPR)))" data-ref="_M/RSET_FPR">RSET_FPR</a>, <a class="local col8 ref" href="#118r" title='r' data-ref="118r" data-ref-filename="118r">r</a>)) {</td></tr>
<tr><th id="390">390</th><td>    <a class="local col0 ref" href="#120r64" title='r64' data-ref="120r64" data-ref-filename="120r64">r64</a> = <a class="local col8 ref" href="#118r" title='r' data-ref="118r" data-ref-filename="118r">r</a>;</td></tr>
<tr><th id="391">391</th><td>    <a class="local col1 ref" href="#121xo" title='xo' data-ref="121xo" data-ref-filename="121xo">xo</a> = <a class="enum" href="lj_target_x86.h.html#XO_MOVSD" title='XO_MOVSD' data-ref="XO_MOVSD" data-ref-filename="XO_MOVSD">XO_MOVSD</a>;</td></tr>
<tr><th id="392">392</th><td>  } <b>else</b> {</td></tr>
<tr><th id="393">393</th><td>    <a class="local col0 ref" href="#120r64" title='r64' data-ref="120r64" data-ref-filename="120r64">r64</a> = <a class="local col8 ref" href="#118r" title='r' data-ref="118r" data-ref-filename="118r">r</a> | <a class="macro" href="#15" title="(0x200|0x080000)" data-ref="_M/REX_64">REX_64</a>;</td></tr>
<tr><th id="394">394</th><td>    <a class="local col1 ref" href="#121xo" title='xo' data-ref="121xo" data-ref-filename="121xo">xo</a> = <a class="enum" href="lj_target_x86.h.html#XO_MOV" title='XO_MOV' data-ref="XO_MOV" data-ref-filename="XO_MOV">XO_MOV</a>;</td></tr>
<tr><th id="395">395</th><td>  }</td></tr>
<tr><th id="396">396</th><td>  <b>if</b> (*<a class="local col2 ref" href="#122k" title='k' data-ref="122k" data-ref-filename="122k">k</a> == <var>0</var>) {</td></tr>
<tr><th id="397">397</th><td>    <a class="ref fn" href="#emit_rr" title='emit_rr' data-ref="emit_rr" data-ref-filename="emit_rr">emit_rr</a>(<a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>, <a class="macro" href="lj_target.h.html#68" title="((int)((((((((RegSet)1) &lt;&lt; ((RID_MAX_FPR)-(RID_MIN_FPR)))-1) &lt;&lt; (RID_MIN_FPR)))) &gt;&gt; (r)) &amp; 1)" data-ref="_M/rset_test">rset_test</a>(<a class="macro" href="lj_target_x86.h.html#71" title="((((((RegSet)1) &lt;&lt; ((RID_MAX_FPR)-(RID_MIN_FPR)))-1) &lt;&lt; (RID_MIN_FPR)))" data-ref="_M/RSET_FPR">RSET_FPR</a>, <a class="local col8 ref" href="#118r" title='r' data-ref="118r" data-ref-filename="118r">r</a>) ? <a class="enum" href="lj_target_x86.h.html#XO_XORPS" title='XO_XORPS' data-ref="XO_XORPS" data-ref-filename="XO_XORPS">XO_XORPS</a> : <a class="macro" href="lj_target_x86.h.html#328" title="((x86Op)(0x030000fe + ((XOg_XOR)&lt;&lt;27)))" data-ref="_M/XO_ARITH">XO_ARITH</a>(<a class="enum" href="lj_target_x86.h.html#XOg_XOR" title='XOg_XOR' data-ref="XOg_XOR" data-ref-filename="XOg_XOR">XOg_XOR</a>), <a class="local col8 ref" href="#118r" title='r' data-ref="118r" data-ref-filename="118r">r</a>, <a class="local col8 ref" href="#118r" title='r' data-ref="118r" data-ref-filename="118r">r</a>);</td></tr>
<tr><th id="398">398</th><td><u>#<span data-ppcond="398">if</span> <a class="macro" href="lj_arch.h.html#526" title="1" data-ref="_M/LJ_GC64">LJ_GC64</a></u></td></tr>
<tr><th id="399">399</th><td>  } <b>else</b> <b>if</b> (<a class="macro" href="lj_def.h.html#105" title="(((intptr_t)k) == (int32_t)((intptr_t)k))" data-ref="_M/checki32">checki32</a>((<a class="typedef" href="../include/stdint.h.html#intptr_t" title='intptr_t' data-type='long' data-ref="intptr_t" data-ref-filename="intptr_t">intptr_t</a>)<a class="local col2 ref" href="#122k" title='k' data-ref="122k" data-ref-filename="122k">k</a>) || <a class="macro" href="lj_def.h.html#105" title="((((intptr_t)((uintptr_t)(k) - (uintptr_t)((GG_State *)((char *)(as-&gt;J) - ((int)__builtin_offsetof(GG_State, J))))-&gt;dispatch))) == (int32_t)(((intptr_t)((uintptr_t)(k) - (uintptr_t)((GG_State *)((char *)(as-&gt;J) - ((int)__builtin_offsetof(GG_State, J))))-&gt;dispatch))))" data-ref="_M/checki32">checki32</a>(<a class="macro" href="#295" title="((intptr_t)((uintptr_t)(k) - (uintptr_t)((GG_State *)((char *)(as-&gt;J) - ((int)__builtin_offsetof(GG_State, J))))-&gt;dispatch))" data-ref="_M/dispofs">dispofs</a>(<a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>, <a class="local col2 ref" href="#122k" title='k' data-ref="122k" data-ref-filename="122k">k</a>)) ||</td></tr>
<tr><th id="400">400</th><td>	     (<a class="macro" href="lj_def.h.html#105" title="((((intptr_t)((uintptr_t)(k) - (uintptr_t)as-&gt;mcp))) == (int32_t)(((intptr_t)((uintptr_t)(k) - (uintptr_t)as-&gt;mcp))))" data-ref="_M/checki32">checki32</a>(<a class="macro" href="#297" title="((intptr_t)((uintptr_t)(k) - (uintptr_t)as-&gt;mcp))" data-ref="_M/mcpofs">mcpofs</a>(<a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>, <a class="local col2 ref" href="#122k" title='k' data-ref="122k" data-ref-filename="122k">k</a>)) &amp;&amp; <a class="macro" href="lj_def.h.html#105" title="((((intptr_t)((uintptr_t)(k) - (uintptr_t)as-&gt;mctop))) == (int32_t)(((intptr_t)((uintptr_t)(k) - (uintptr_t)as-&gt;mctop))))" data-ref="_M/checki32">checki32</a>(<a class="macro" href="#299" title="((intptr_t)((uintptr_t)(k) - (uintptr_t)as-&gt;mctop))" data-ref="_M/mctopofs">mctopofs</a>(<a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>, <a class="local col2 ref" href="#122k" title='k' data-ref="122k" data-ref-filename="122k">k</a>)))) {</td></tr>
<tr><th id="401">401</th><td>    <a class="ref fn" href="#emit_rma" title='emit_rma' data-ref="emit_rma" data-ref-filename="emit_rma">emit_rma</a>(<a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>, <a class="local col1 ref" href="#121xo" title='xo' data-ref="121xo" data-ref-filename="121xo">xo</a>, <a class="local col0 ref" href="#120r64" title='r64' data-ref="120r64" data-ref-filename="120r64">r64</a>, <a class="local col2 ref" href="#122k" title='k' data-ref="122k" data-ref-filename="122k">k</a>);</td></tr>
<tr><th id="402">402</th><td>  } <b>else</b> {</td></tr>
<tr><th id="403">403</th><td>    <b>if</b> (<a class="local col9 ref" href="#119ir" title='ir' data-ref="119ir" data-ref-filename="119ir">ir</a>-&gt;<a class="ref field" href="lj_ir.h.html#IRIns::i" title='IRIns::i' data-ref="IRIns::i" data-ref-filename="IRIns..i">i</a>) {</td></tr>
<tr><th id="404">404</th><td>      <a class="macro" href="lj_asm.c.html#106" title="((void)as)" data-ref="_M/lj_assertA">lj_assertA</a>(*k == *(uint64_t*)(as-&gt;mctop - ir-&gt;i),</td></tr>
<tr><th id="405">405</th><td>		 <q>"bad interned 64 bit constant"</q>);</td></tr>
<tr><th id="406">406</th><td>    } <b>else</b> <b>if</b> (<a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::curins" title='ASMState::curins' data-use='r' data-ref="ASMState::curins" data-ref-filename="ASMState..curins">curins</a> &lt;= <a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::stopins" title='ASMState::stopins' data-use='r' data-ref="ASMState::stopins" data-ref-filename="ASMState..stopins">stopins</a> &amp;&amp; <a class="macro" href="lj_target.h.html#68" title="((int)((((((((RegSet)1) &lt;&lt; ((RID_MAX_GPR)-(RID_MIN_GPR)))-1) &lt;&lt; (RID_MIN_GPR)) - (((RegSet)1) &lt;&lt; (RID_ESP)) - 1*(((RegSet)1) &lt;&lt; (RID_DISPATCH)))) &gt;&gt; (r)) &amp; 1)" data-ref="_M/rset_test">rset_test</a>(<a class="macro" href="lj_target_x86.h.html#68" title="((((((RegSet)1) &lt;&lt; ((RID_MAX_GPR)-(RID_MIN_GPR)))-1) &lt;&lt; (RID_MIN_GPR)) - (((RegSet)1) &lt;&lt; (RID_ESP)) - 1*(((RegSet)1) &lt;&lt; (RID_DISPATCH)))" data-ref="_M/RSET_GPR">RSET_GPR</a>, <a class="local col8 ref" href="#118r" title='r' data-ref="118r" data-ref-filename="118r">r</a>)) {</td></tr>
<tr><th id="407">407</th><td>      <a class="ref fn" href="#emit_loadu64" title='emit_loadu64' data-ref="emit_loadu64" data-ref-filename="emit_loadu64">emit_loadu64</a>(<a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>, <a class="local col8 ref" href="#118r" title='r' data-ref="118r" data-ref-filename="118r">r</a>, *<a class="local col2 ref" href="#122k" title='k' data-ref="122k" data-ref-filename="122k">k</a>);</td></tr>
<tr><th id="408">408</th><td>      <b>return</b>;</td></tr>
<tr><th id="409">409</th><td>    } <b>else</b> {</td></tr>
<tr><th id="410">410</th><td>      <i>/* If all else fails, add the FP constant at the MCode area bottom. */</i></td></tr>
<tr><th id="411">411</th><td>      <b>while</b> ((<a class="typedef" href="../include/stdint.h.html#uintptr_t" title='uintptr_t' data-type='unsigned long' data-ref="uintptr_t" data-ref-filename="uintptr_t">uintptr_t</a>)<a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcbot" title='ASMState::mcbot' data-use='r' data-ref="ASMState::mcbot" data-ref-filename="ASMState..mcbot">mcbot</a> &amp; <var>7</var>) *<a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcbot" title='ASMState::mcbot' data-use='w' data-ref="ASMState::mcbot" data-ref-filename="ASMState..mcbot">mcbot</a>++ = <a class="enum" href="lj_target_x86.h.html#XI_INT3" title='XI_INT3' data-ref="XI_INT3" data-ref-filename="XI_INT3">XI_INT3</a>;</td></tr>
<tr><th id="412">412</th><td>      *(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-uintn.h.html#uint64_t" title='uint64_t' data-type='__uint64_t' data-ref="uint64_t" data-ref-filename="uint64_t">uint64_t</a> *)<a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcbot" title='ASMState::mcbot' data-use='r' data-ref="ASMState::mcbot" data-ref-filename="ASMState..mcbot">mcbot</a> = *<a class="local col2 ref" href="#122k" title='k' data-ref="122k" data-ref-filename="122k">k</a>;</td></tr>
<tr><th id="413">413</th><td>      <a class="local col9 ref" href="#119ir" title='ir' data-ref="119ir" data-ref-filename="119ir">ir</a>-&gt;<a class="ref field" href="lj_ir.h.html#IRIns::i" title='IRIns::i' data-ref="IRIns::i" data-ref-filename="IRIns..i">i</a> = (<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a>)(<a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mctop" title='ASMState::mctop' data-use='r' data-ref="ASMState::mctop" data-ref-filename="ASMState..mctop">mctop</a> - <a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcbot" title='ASMState::mcbot' data-use='r' data-ref="ASMState::mcbot" data-ref-filename="ASMState..mcbot">mcbot</a>);</td></tr>
<tr><th id="414">414</th><td>      <a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcbot" title='ASMState::mcbot' data-use='w' data-ref="ASMState::mcbot" data-ref-filename="ASMState..mcbot">mcbot</a> += <var>8</var>;</td></tr>
<tr><th id="415">415</th><td>      <a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mclim" title='ASMState::mclim' data-use='w' data-ref="ASMState::mclim" data-ref-filename="ASMState..mclim">mclim</a> = <a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcbot" title='ASMState::mcbot' data-use='r' data-ref="ASMState::mcbot" data-ref-filename="ASMState..mcbot">mcbot</a> + <a class="macro" href="lj_asm.c.html#128" title="64" data-ref="_M/MCLIM_REDZONE">MCLIM_REDZONE</a>;</td></tr>
<tr><th id="416">416</th><td>      <a class="macro" href="lj_mcode.h.html#26" title="(as-&gt;J-&gt;mcbot = (as-&gt;mcbot))" data-ref="_M/lj_mcode_commitbot">lj_mcode_commitbot</a>(<a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::J" title='ASMState::J' data-use='r' data-ref="ASMState::J" data-ref-filename="ASMState..J">J</a>, <a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcbot" title='ASMState::mcbot' data-use='r' data-ref="ASMState::mcbot" data-ref-filename="ASMState..mcbot">mcbot</a>);</td></tr>
<tr><th id="417">417</th><td>    }</td></tr>
<tr><th id="418">418</th><td>    <a class="ref fn" href="#emit_rmro" title='emit_rmro' data-ref="emit_rmro" data-ref-filename="emit_rmro">emit_rmro</a>(<a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>, <a class="local col1 ref" href="#121xo" title='xo' data-ref="121xo" data-ref-filename="121xo">xo</a>, <a class="local col0 ref" href="#120r64" title='r64' data-ref="120r64" data-ref-filename="120r64">r64</a>, <a class="enum" href="lj_target_x86.h.html#RID_RIP" title='RID_RIP' data-ref="RID_RIP" data-ref-filename="RID_RIP">RID_RIP</a>, (<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a>)<a class="macro" href="#297" title="((intptr_t)((uintptr_t)(as-&gt;mctop - ir-&gt;i) - (uintptr_t)as-&gt;mcp))" data-ref="_M/mcpofs">mcpofs</a>(<a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>, <a class="local col7 ref" href="#117as" title='as' data-ref="117as" data-ref-filename="117as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mctop" title='ASMState::mctop' data-use='r' data-ref="ASMState::mctop" data-ref-filename="ASMState..mctop">mctop</a> - <a class="local col9 ref" href="#119ir" title='ir' data-ref="119ir" data-ref-filename="119ir">ir</a>-&gt;<a class="ref field" href="lj_ir.h.html#IRIns::i" title='IRIns::i' data-ref="IRIns::i" data-ref-filename="IRIns..i">i</a>));</td></tr>
<tr><th id="419">419</th><td><u>#<span data-ppcond="398">else</span></u></td></tr>
<tr><th id="420">420</th><td>  } <b>else</b> {</td></tr>
<tr><th id="421">421</th><td>    emit_rma(as, xo, r64, k);</td></tr>
<tr><th id="422">422</th><td><u>#<span data-ppcond="398">endif</span></u></td></tr>
<tr><th id="423">423</th><td>  }</td></tr>
<tr><th id="424">424</th><td>}</td></tr>
<tr><th id="425">425</th><td></td></tr>
<tr><th id="426">426</th><td><i>/* -- Emit control-flow instructions -------------------------------------- */</i></td></tr>
<tr><th id="427">427</th><td></td></tr>
<tr><th id="428">428</th><td><i>/* Label for short jumps. */</i></td></tr>
<tr><th id="429">429</th><td><b>typedef</b> <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="typedef" id="MCLabel" title='MCLabel' data-type='MCode *' data-ref="MCLabel" data-ref-filename="MCLabel">MCLabel</dfn>;</td></tr>
<tr><th id="430">430</th><td></td></tr>
<tr><th id="431">431</th><td><u>#<span data-ppcond="431">if</span> <a class="macro" href="lj_arch.h.html#599" title="0" data-ref="_M/LJ_32">LJ_32</a> &amp;&amp; <a class="macro" href="lj_arch.h.html#549" title="1" data-ref="_M/LJ_HASFFI">LJ_HASFFI</a></u></td></tr>
<tr><th id="432">432</th><td><i>/* jmp short target */</i></td></tr>
<tr><th id="433">433</th><td><em>static</em> <em>void</em> emit_sjmp(ASMState *as, MCLabel target)</td></tr>
<tr><th id="434">434</th><td>{</td></tr>
<tr><th id="435">435</th><td>  MCode *p = as-&gt;mcp;</td></tr>
<tr><th id="436">436</th><td>  ptrdiff_t delta = target - p;</td></tr>
<tr><th id="437">437</th><td>  lj_assertA(delta == (int8_t)delta, <q>"short jump target out of range"</q>);</td></tr>
<tr><th id="438">438</th><td>  p[-<var>1</var>] = (MCode)(int8_t)delta;</td></tr>
<tr><th id="439">439</th><td>  p[-<var>2</var>] = XI_JMPs;</td></tr>
<tr><th id="440">440</th><td>  as-&gt;mcp = p - <var>2</var>;</td></tr>
<tr><th id="441">441</th><td>}</td></tr>
<tr><th id="442">442</th><td><u>#<span data-ppcond="431">endif</span></u></td></tr>
<tr><th id="443">443</th><td></td></tr>
<tr><th id="444">444</th><td><i>/* jcc short target */</i></td></tr>
<tr><th id="445">445</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_sjcc" title='emit_sjcc' data-ref="emit_sjcc" data-ref-filename="emit_sjcc">emit_sjcc</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col3 decl" id="123as" title='as' data-type='ASMState *' data-ref="123as" data-ref-filename="123as">as</dfn>, <em>int</em> <dfn class="local col4 decl" id="124cc" title='cc' data-type='int' data-ref="124cc" data-ref-filename="124cc">cc</dfn>, <a class="typedef" href="#MCLabel" title='MCLabel' data-type='MCode *' data-ref="MCLabel" data-ref-filename="MCLabel">MCLabel</a> <dfn class="local col5 decl" id="125target" title='target' data-type='MCLabel' data-ref="125target" data-ref-filename="125target">target</dfn>)</td></tr>
<tr><th id="446">446</th><td>{</td></tr>
<tr><th id="447">447</th><td>  <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col6 decl" id="126p" title='p' data-type='MCode *' data-ref="126p" data-ref-filename="126p">p</dfn> = <a class="local col3 ref" href="#123as" title='as' data-ref="123as" data-ref-filename="123as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a>;</td></tr>
<tr><th id="448">448</th><td>  <span class='typedef' title='ptrdiff_t' data-type='long' data-ref="ptrdiff_t" data-ref-filename="ptrdiff_t">ptrdiff_t</span> <dfn class="local col7 decl" id="127delta" title='delta' data-type='ptrdiff_t' data-ref="127delta" data-ref-filename="127delta">delta</dfn> = <a class="local col5 ref" href="#125target" title='target' data-ref="125target" data-ref-filename="125target">target</a> - <a class="local col6 ref" href="#126p" title='p' data-ref="126p" data-ref-filename="126p">p</a>;</td></tr>
<tr><th id="449">449</th><td>  <a class="macro" href="lj_asm.c.html#106" title="((void)as)" data-ref="_M/lj_assertA">lj_assertA</a>(delta == (int8_t)delta, <q>"short jump target out of range"</q>);</td></tr>
<tr><th id="450">450</th><td>  <a class="local col6 ref" href="#126p" title='p' data-ref="126p" data-ref-filename="126p">p</a>[-<var>1</var>] = (<a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a>)(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int8_t" title='int8_t' data-type='__int8_t' data-ref="int8_t" data-ref-filename="int8_t">int8_t</a>)<a class="local col7 ref" href="#127delta" title='delta' data-ref="127delta" data-ref-filename="127delta">delta</a>;</td></tr>
<tr><th id="451">451</th><td>  <a class="local col6 ref" href="#126p" title='p' data-ref="126p" data-ref-filename="126p">p</a>[-<var>2</var>] = (<a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a>)(<a class="enum" href="lj_target_x86.h.html#XI_JCCs" title='XI_JCCs' data-ref="XI_JCCs" data-ref-filename="XI_JCCs">XI_JCCs</a>+(<a class="local col4 ref" href="#124cc" title='cc' data-ref="124cc" data-ref-filename="124cc">cc</a>&amp;<var>15</var>));</td></tr>
<tr><th id="452">452</th><td>  <a class="local col3 ref" href="#123as" title='as' data-ref="123as" data-ref-filename="123as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='w' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a> = <a class="local col6 ref" href="#126p" title='p' data-ref="126p" data-ref-filename="126p">p</a> - <var>2</var>;</td></tr>
<tr><th id="453">453</th><td>}</td></tr>
<tr><th id="454">454</th><td></td></tr>
<tr><th id="455">455</th><td><i>/* jcc short (pending target) */</i></td></tr>
<tr><th id="456">456</th><td><em>static</em> <a class="typedef" href="#MCLabel" title='MCLabel' data-type='MCode *' data-ref="MCLabel" data-ref-filename="MCLabel">MCLabel</a> <dfn class="decl def fn" id="emit_sjcc_label" title='emit_sjcc_label' data-ref="emit_sjcc_label" data-ref-filename="emit_sjcc_label">emit_sjcc_label</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col8 decl" id="128as" title='as' data-type='ASMState *' data-ref="128as" data-ref-filename="128as">as</dfn>, <em>int</em> <dfn class="local col9 decl" id="129cc" title='cc' data-type='int' data-ref="129cc" data-ref-filename="129cc">cc</dfn>)</td></tr>
<tr><th id="457">457</th><td>{</td></tr>
<tr><th id="458">458</th><td>  <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col0 decl" id="130p" title='p' data-type='MCode *' data-ref="130p" data-ref-filename="130p">p</dfn> = <a class="local col8 ref" href="#128as" title='as' data-ref="128as" data-ref-filename="128as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a>;</td></tr>
<tr><th id="459">459</th><td>  <a class="local col0 ref" href="#130p" title='p' data-ref="130p" data-ref-filename="130p">p</a>[-<var>1</var>] = <var>0</var>;</td></tr>
<tr><th id="460">460</th><td>  <a class="local col0 ref" href="#130p" title='p' data-ref="130p" data-ref-filename="130p">p</a>[-<var>2</var>] = (<a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a>)(<a class="enum" href="lj_target_x86.h.html#XI_JCCs" title='XI_JCCs' data-ref="XI_JCCs" data-ref-filename="XI_JCCs">XI_JCCs</a>+(<a class="local col9 ref" href="#129cc" title='cc' data-ref="129cc" data-ref-filename="129cc">cc</a>&amp;<var>15</var>));</td></tr>
<tr><th id="461">461</th><td>  <a class="local col8 ref" href="#128as" title='as' data-ref="128as" data-ref-filename="128as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='w' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a> = <a class="local col0 ref" href="#130p" title='p' data-ref="130p" data-ref-filename="130p">p</a> - <var>2</var>;</td></tr>
<tr><th id="462">462</th><td>  <b>return</b> <a class="local col0 ref" href="#130p" title='p' data-ref="130p" data-ref-filename="130p">p</a>;</td></tr>
<tr><th id="463">463</th><td>}</td></tr>
<tr><th id="464">464</th><td></td></tr>
<tr><th id="465">465</th><td><i>/* Fixup jcc short target. */</i></td></tr>
<tr><th id="466">466</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_sfixup" title='emit_sfixup' data-ref="emit_sfixup" data-ref-filename="emit_sfixup">emit_sfixup</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col1 decl" id="131as" title='as' data-type='ASMState *' data-ref="131as" data-ref-filename="131as">as</dfn>, <a class="typedef" href="#MCLabel" title='MCLabel' data-type='MCode *' data-ref="MCLabel" data-ref-filename="MCLabel">MCLabel</a> <dfn class="local col2 decl" id="132source" title='source' data-type='MCLabel' data-ref="132source" data-ref-filename="132source">source</dfn>)</td></tr>
<tr><th id="467">467</th><td>{</td></tr>
<tr><th id="468">468</th><td>  <a class="local col2 ref" href="#132source" title='source' data-ref="132source" data-ref-filename="132source">source</a>[-<var>1</var>] = (<a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a>)(<a class="local col1 ref" href="#131as" title='as' data-ref="131as" data-ref-filename="131as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a>-<a class="local col2 ref" href="#132source" title='source' data-ref="132source" data-ref-filename="132source">source</a>);</td></tr>
<tr><th id="469">469</th><td>}</td></tr>
<tr><th id="470">470</th><td></td></tr>
<tr><th id="471">471</th><td><i>/* Return label pointing to current PC. */</i></td></tr>
<tr><th id="472">472</th><td><u>#define <dfn class="macro" id="_M/emit_label" data-ref="_M/emit_label">emit_label</dfn>(as)		((as)-&gt;mcp)</u></td></tr>
<tr><th id="473">473</th><td></td></tr>
<tr><th id="474">474</th><td><i>/* Compute relative 32 bit offset for jump and call instructions. */</i></td></tr>
<tr><th id="475">475</th><td><em>static</em> <a class="macro" href="lj_def.h.html#128" title="inline __attribute__((always_inline))" data-ref="_M/LJ_AINLINE">LJ_AINLINE</a> <a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> <dfn class="decl def fn" id="jmprel" title='jmprel' data-ref="jmprel" data-ref-filename="jmprel">jmprel</dfn>(<a class="typedef" href="lj_jit.h.html#jit_State" title='jit_State' data-type='struct jit_State' data-ref="jit_State" data-ref-filename="jit_State">jit_State</a> *<dfn class="local col3 decl" id="133J" title='J' data-type='jit_State *' data-ref="133J" data-ref-filename="133J">J</dfn>, <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col4 decl" id="134p" title='p' data-type='MCode *' data-ref="134p" data-ref-filename="134p">p</dfn>, <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col5 decl" id="135target" title='target' data-type='MCode *' data-ref="135target" data-ref-filename="135target">target</dfn>)</td></tr>
<tr><th id="476">476</th><td>{</td></tr>
<tr><th id="477">477</th><td>  <span class='typedef' title='ptrdiff_t' data-type='long' data-ref="ptrdiff_t" data-ref-filename="ptrdiff_t">ptrdiff_t</span> <dfn class="local col6 decl" id="136delta" title='delta' data-type='ptrdiff_t' data-ref="136delta" data-ref-filename="136delta">delta</dfn> = <a class="local col5 ref" href="#135target" title='target' data-ref="135target" data-ref-filename="135target">target</a> - <a class="local col4 ref" href="#134p" title='p' data-ref="134p" data-ref-filename="134p">p</a>;</td></tr>
<tr><th id="478">478</th><td>  <a class="macro" href="lj_def.h.html#91" title="((void)(J))" data-ref="_M/UNUSED">UNUSED</a>(<a class="local col3 ref" href="#133J" title='J' data-ref="133J" data-ref-filename="133J">J</a>);</td></tr>
<tr><th id="479">479</th><td>  <a class="macro" href="lj_jit.h.html#513" title="((void)J)" data-ref="_M/lj_assertJ">lj_assertJ</a>(delta == (int32_t)delta, <q>"jump target out of range"</q>);</td></tr>
<tr><th id="480">480</th><td>  <b>return</b> (<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a>)<a class="local col6 ref" href="#136delta" title='delta' data-ref="136delta" data-ref-filename="136delta">delta</a>;</td></tr>
<tr><th id="481">481</th><td>}</td></tr>
<tr><th id="482">482</th><td></td></tr>
<tr><th id="483">483</th><td><i>/* jcc target */</i></td></tr>
<tr><th id="484">484</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_jcc" title='emit_jcc' data-ref="emit_jcc" data-ref-filename="emit_jcc">emit_jcc</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col7 decl" id="137as" title='as' data-type='ASMState *' data-ref="137as" data-ref-filename="137as">as</dfn>, <em>int</em> <dfn class="local col8 decl" id="138cc" title='cc' data-type='int' data-ref="138cc" data-ref-filename="138cc">cc</dfn>, <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col9 decl" id="139target" title='target' data-type='MCode *' data-ref="139target" data-ref-filename="139target">target</dfn>)</td></tr>
<tr><th id="485">485</th><td>{</td></tr>
<tr><th id="486">486</th><td>  <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col0 decl" id="140p" title='p' data-type='MCode *' data-ref="140p" data-ref-filename="140p">p</dfn> = <a class="local col7 ref" href="#137as" title='as' data-ref="137as" data-ref-filename="137as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a>;</td></tr>
<tr><th id="487">487</th><td>  *(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> *)(<a class="local col0 ref" href="#140p" title='p' data-ref="140p" data-ref-filename="140p">p</a>-<var>4</var>) = <a class="ref fn" href="#jmprel" title='jmprel' data-ref="jmprel" data-ref-filename="jmprel">jmprel</a>(<a class="local col7 ref" href="#137as" title='as' data-ref="137as" data-ref-filename="137as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::J" title='ASMState::J' data-use='r' data-ref="ASMState::J" data-ref-filename="ASMState..J">J</a>, <a class="local col0 ref" href="#140p" title='p' data-ref="140p" data-ref-filename="140p">p</a>, <a class="local col9 ref" href="#139target" title='target' data-ref="139target" data-ref-filename="139target">target</a>);</td></tr>
<tr><th id="488">488</th><td>  <a class="local col0 ref" href="#140p" title='p' data-ref="140p" data-ref-filename="140p">p</a>[-<var>5</var>] = (<a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a>)(<a class="enum" href="lj_target_x86.h.html#XI_JCCn" title='XI_JCCn' data-ref="XI_JCCn" data-ref-filename="XI_JCCn">XI_JCCn</a>+(<a class="local col8 ref" href="#138cc" title='cc' data-ref="138cc" data-ref-filename="138cc">cc</a>&amp;<var>15</var>));</td></tr>
<tr><th id="489">489</th><td>  <a class="local col0 ref" href="#140p" title='p' data-ref="140p" data-ref-filename="140p">p</a>[-<var>6</var>] = <var>0x0f</var>;</td></tr>
<tr><th id="490">490</th><td>  <a class="local col7 ref" href="#137as" title='as' data-ref="137as" data-ref-filename="137as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='w' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a> = <a class="local col0 ref" href="#140p" title='p' data-ref="140p" data-ref-filename="140p">p</a> - <var>6</var>;</td></tr>
<tr><th id="491">491</th><td>}</td></tr>
<tr><th id="492">492</th><td></td></tr>
<tr><th id="493">493</th><td><i>/* jmp target */</i></td></tr>
<tr><th id="494">494</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_jmp" title='emit_jmp' data-ref="emit_jmp" data-ref-filename="emit_jmp">emit_jmp</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col1 decl" id="141as" title='as' data-type='ASMState *' data-ref="141as" data-ref-filename="141as">as</dfn>, <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col2 decl" id="142target" title='target' data-type='MCode *' data-ref="142target" data-ref-filename="142target">target</dfn>)</td></tr>
<tr><th id="495">495</th><td>{</td></tr>
<tr><th id="496">496</th><td>  <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col3 decl" id="143p" title='p' data-type='MCode *' data-ref="143p" data-ref-filename="143p">p</dfn> = <a class="local col1 ref" href="#141as" title='as' data-ref="141as" data-ref-filename="141as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a>;</td></tr>
<tr><th id="497">497</th><td>  *(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> *)(<a class="local col3 ref" href="#143p" title='p' data-ref="143p" data-ref-filename="143p">p</a>-<var>4</var>) = <a class="ref fn" href="#jmprel" title='jmprel' data-ref="jmprel" data-ref-filename="jmprel">jmprel</a>(<a class="local col1 ref" href="#141as" title='as' data-ref="141as" data-ref-filename="141as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::J" title='ASMState::J' data-use='r' data-ref="ASMState::J" data-ref-filename="ASMState..J">J</a>, <a class="local col3 ref" href="#143p" title='p' data-ref="143p" data-ref-filename="143p">p</a>, <a class="local col2 ref" href="#142target" title='target' data-ref="142target" data-ref-filename="142target">target</a>);</td></tr>
<tr><th id="498">498</th><td>  <a class="local col3 ref" href="#143p" title='p' data-ref="143p" data-ref-filename="143p">p</a>[-<var>5</var>] = <a class="enum" href="lj_target_x86.h.html#XI_JMP" title='XI_JMP' data-ref="XI_JMP" data-ref-filename="XI_JMP">XI_JMP</a>;</td></tr>
<tr><th id="499">499</th><td>  <a class="local col1 ref" href="#141as" title='as' data-ref="141as" data-ref-filename="141as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='w' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a> = <a class="local col3 ref" href="#143p" title='p' data-ref="143p" data-ref-filename="143p">p</a> - <var>5</var>;</td></tr>
<tr><th id="500">500</th><td>}</td></tr>
<tr><th id="501">501</th><td></td></tr>
<tr><th id="502">502</th><td><i>/* call target */</i></td></tr>
<tr><th id="503">503</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_call_" title='emit_call_' data-ref="emit_call_" data-ref-filename="emit_call_">emit_call_</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col4 decl" id="144as" title='as' data-type='ASMState *' data-ref="144as" data-ref-filename="144as">as</dfn>, <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col5 decl" id="145target" title='target' data-type='MCode *' data-ref="145target" data-ref-filename="145target">target</dfn>)</td></tr>
<tr><th id="504">504</th><td>{</td></tr>
<tr><th id="505">505</th><td>  <a class="typedef" href="lj_jit.h.html#MCode" title='MCode' data-type='uint8_t' data-ref="MCode" data-ref-filename="MCode">MCode</a> *<dfn class="local col6 decl" id="146p" title='p' data-type='MCode *' data-ref="146p" data-ref-filename="146p">p</dfn> = <a class="local col4 ref" href="#144as" title='as' data-ref="144as" data-ref-filename="144as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='r' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a>;</td></tr>
<tr><th id="506">506</th><td><u>#<span data-ppcond="506">if</span> <a class="macro" href="lj_arch.h.html#600" title="1" data-ref="_M/LJ_64">LJ_64</a></u></td></tr>
<tr><th id="507">507</th><td>  <b>if</b> (<a class="local col5 ref" href="#145target" title='target' data-ref="145target" data-ref-filename="145target">target</a>-<a class="local col6 ref" href="#146p" title='p' data-ref="146p" data-ref-filename="146p">p</a> != (<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a>)(<a class="local col5 ref" href="#145target" title='target' data-ref="145target" data-ref-filename="145target">target</a>-<a class="local col6 ref" href="#146p" title='p' data-ref="146p" data-ref-filename="146p">p</a>)) {</td></tr>
<tr><th id="508">508</th><td>    <i>/* Assumes RID_RET is never an argument to calls and always clobbered. */</i></td></tr>
<tr><th id="509">509</th><td>    <a class="ref fn" href="#emit_rr" title='emit_rr' data-ref="emit_rr" data-ref-filename="emit_rr">emit_rr</a>(<a class="local col4 ref" href="#144as" title='as' data-ref="144as" data-ref-filename="144as">as</a>, <a class="enum" href="lj_target_x86.h.html#XO_GROUP5" title='XO_GROUP5' data-ref="XO_GROUP5" data-ref-filename="XO_GROUP5">XO_GROUP5</a>, <a class="enum" href="lj_target_x86.h.html#XOg_CALL" title='XOg_CALL' data-ref="XOg_CALL" data-ref-filename="XOg_CALL">XOg_CALL</a>, <a class="enum" href="lj_target_x86.h.html#RID_RET" title='RID_RET' data-ref="RID_RET" data-ref-filename="RID_RET">RID_RET</a>);</td></tr>
<tr><th id="510">510</th><td>    <a class="ref fn" href="#emit_loadu64" title='emit_loadu64' data-ref="emit_loadu64" data-ref-filename="emit_loadu64">emit_loadu64</a>(<a class="local col4 ref" href="#144as" title='as' data-ref="144as" data-ref-filename="144as">as</a>, <a class="enum" href="lj_target_x86.h.html#RID_RET" title='RID_RET' data-ref="RID_RET" data-ref-filename="RID_RET">RID_RET</a>, (<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-uintn.h.html#uint64_t" title='uint64_t' data-type='__uint64_t' data-ref="uint64_t" data-ref-filename="uint64_t">uint64_t</a>)<a class="local col5 ref" href="#145target" title='target' data-ref="145target" data-ref-filename="145target">target</a>);</td></tr>
<tr><th id="511">511</th><td>    <b>return</b>;</td></tr>
<tr><th id="512">512</th><td>  }</td></tr>
<tr><th id="513">513</th><td><u>#<span data-ppcond="506">endif</span></u></td></tr>
<tr><th id="514">514</th><td>  *(<a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> *)(<a class="local col6 ref" href="#146p" title='p' data-ref="146p" data-ref-filename="146p">p</a>-<var>4</var>) = <a class="ref fn" href="#jmprel" title='jmprel' data-ref="jmprel" data-ref-filename="jmprel">jmprel</a>(<a class="local col4 ref" href="#144as" title='as' data-ref="144as" data-ref-filename="144as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::J" title='ASMState::J' data-use='r' data-ref="ASMState::J" data-ref-filename="ASMState..J">J</a>, <a class="local col6 ref" href="#146p" title='p' data-ref="146p" data-ref-filename="146p">p</a>, <a class="local col5 ref" href="#145target" title='target' data-ref="145target" data-ref-filename="145target">target</a>);</td></tr>
<tr><th id="515">515</th><td>  <a class="local col6 ref" href="#146p" title='p' data-ref="146p" data-ref-filename="146p">p</a>[-<var>5</var>] = <a class="enum" href="lj_target_x86.h.html#XI_CALL" title='XI_CALL' data-ref="XI_CALL" data-ref-filename="XI_CALL">XI_CALL</a>;</td></tr>
<tr><th id="516">516</th><td>  <a class="local col4 ref" href="#144as" title='as' data-ref="144as" data-ref-filename="144as">as</a>-&gt;<a class="tu ref field" href="lj_asm.c.html#ASMState::mcp" title='ASMState::mcp' data-use='w' data-ref="ASMState::mcp" data-ref-filename="ASMState..mcp">mcp</a> = <a class="local col6 ref" href="#146p" title='p' data-ref="146p" data-ref-filename="146p">p</a> - <var>5</var>;</td></tr>
<tr><th id="517">517</th><td>}</td></tr>
<tr><th id="518">518</th><td></td></tr>
<tr><th id="519">519</th><td><u>#define <dfn class="macro" id="_M/emit_call" data-ref="_M/emit_call">emit_call</dfn>(as, f)	emit_call_(as, (MCode *)(void *)(f))</u></td></tr>
<tr><th id="520">520</th><td></td></tr>
<tr><th id="521">521</th><td><i>/* -- Emit generic operations --------------------------------------------- */</i></td></tr>
<tr><th id="522">522</th><td></td></tr>
<tr><th id="523">523</th><td><i>/* Use 64 bit operations to handle 64 bit IR types. */</i></td></tr>
<tr><th id="524">524</th><td><u>#<span data-ppcond="524">if</span> <a class="macro" href="lj_arch.h.html#600" title="1" data-ref="_M/LJ_64">LJ_64</a></u></td></tr>
<tr><th id="525">525</th><td><u>#define <dfn class="macro" id="_M/REX_64IR" data-ref="_M/REX_64IR">REX_64IR</dfn>(ir, r)		((r) + (irt_is64((ir)-&gt;<a class="ref field" href="lj_ir.h.html#551" title='IRIns::(anonymous struct)::t' data-ref="IRIns::(anonymous)::t" data-ref-filename="IRIns..(anonymous)..t">t</a>) ? REX_64 : 0))</u></td></tr>
<tr><th id="526">526</th><td><u>#define <dfn class="macro" id="_M/VEX_64IR" data-ref="_M/VEX_64IR">VEX_64IR</dfn>(ir, r)		((r) + (irt_is64((ir)-&gt;t) ? VEX_64 : 0))</u></td></tr>
<tr><th id="527">527</th><td><u>#<span data-ppcond="524">else</span></u></td></tr>
<tr><th id="528">528</th><td><u>#define REX_64IR(ir, r)		(r)</u></td></tr>
<tr><th id="529">529</th><td><u>#define VEX_64IR(ir, r)		(r)</u></td></tr>
<tr><th id="530">530</th><td><u>#<span data-ppcond="524">endif</span></u></td></tr>
<tr><th id="531">531</th><td></td></tr>
<tr><th id="532">532</th><td><i>/* Generic move between two regs. */</i></td></tr>
<tr><th id="533">533</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_movrr" title='emit_movrr' data-ref="emit_movrr" data-ref-filename="emit_movrr">emit_movrr</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col7 decl" id="147as" title='as' data-type='ASMState *' data-ref="147as" data-ref-filename="147as">as</dfn>, <a class="typedef" href="lj_ir.h.html#IRIns" title='IRIns' data-type='union IRIns' data-ref="IRIns" data-ref-filename="IRIns">IRIns</a> *<dfn class="local col8 decl" id="148ir" title='ir' data-type='IRIns *' data-ref="148ir" data-ref-filename="148ir">ir</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col9 decl" id="149dst" title='dst' data-type='Reg' data-ref="149dst" data-ref-filename="149dst">dst</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col0 decl" id="150src" title='src' data-type='Reg' data-ref="150src" data-ref-filename="150src">src</dfn>)</td></tr>
<tr><th id="534">534</th><td>{</td></tr>
<tr><th id="535">535</th><td>  <a class="macro" href="lj_def.h.html#91" title="((void)(ir))" data-ref="_M/UNUSED">UNUSED</a>(<a class="local col8 ref" href="#148ir" title='ir' data-ref="148ir" data-ref-filename="148ir">ir</a>);</td></tr>
<tr><th id="536">536</th><td>  <b>if</b> (<a class="local col9 ref" href="#149dst" title='dst' data-ref="149dst" data-ref-filename="149dst">dst</a> &lt; <a class="enum" href="lj_target_x86.h.html#RID_MAX_GPR" title='RID_MAX_GPR' data-ref="RID_MAX_GPR" data-ref-filename="RID_MAX_GPR">RID_MAX_GPR</a>)</td></tr>
<tr><th id="537">537</th><td>    <a class="ref fn" href="#emit_rr" title='emit_rr' data-ref="emit_rr" data-ref-filename="emit_rr">emit_rr</a>(<a class="local col7 ref" href="#147as" title='as' data-ref="147as" data-ref-filename="147as">as</a>, <a class="enum" href="lj_target_x86.h.html#XO_MOV" title='XO_MOV' data-ref="XO_MOV" data-ref-filename="XO_MOV">XO_MOV</a>, <a class="macro" href="#525" title="((dst) + (((((1u&lt;&lt;IRT_NUM)|(1u&lt;&lt;IRT_I64)|(1u&lt;&lt;IRT_U64)|(1u&lt;&lt;IRT_P64)| (1u&lt;&lt;IRT_LIGHTUD)|(1u&lt;&lt;IRT_STR)|(1u&lt;&lt;IRT_THREAD)|(1u&lt;&lt;IRT_PROTO)| (1u&lt;&lt;IRT_FUNC)|(1u&lt;&lt;IRT_CDATA)|(1u&lt;&lt;IRT_TAB)|(1u&lt;&lt;IRT_UDATA)| (1u&lt;&lt;IRT_NIL)) &gt;&gt; ((IRType)(((ir)-&gt;t).irt &amp; IRT_TYPE))) &amp; 1) ? (0x200|0x080000) : 0))" data-ref="_M/REX_64IR">REX_64IR</a>(<a class="local col8 ref" href="#148ir" title='ir' data-ref="148ir" data-ref-filename="148ir">ir</a>, <a class="local col9 ref" href="#149dst" title='dst' data-ref="149dst" data-ref-filename="149dst">dst</a>), <a class="local col0 ref" href="#150src" title='src' data-ref="150src" data-ref-filename="150src">src</a>);</td></tr>
<tr><th id="538">538</th><td>  <b>else</b></td></tr>
<tr><th id="539">539</th><td>    <a class="ref fn" href="#emit_rr" title='emit_rr' data-ref="emit_rr" data-ref-filename="emit_rr">emit_rr</a>(<a class="local col7 ref" href="#147as" title='as' data-ref="147as" data-ref-filename="147as">as</a>, <a class="enum" href="lj_target_x86.h.html#XO_MOVAPS" title='XO_MOVAPS' data-ref="XO_MOVAPS" data-ref-filename="XO_MOVAPS">XO_MOVAPS</a>, <a class="local col9 ref" href="#149dst" title='dst' data-ref="149dst" data-ref-filename="149dst">dst</a>, <a class="local col0 ref" href="#150src" title='src' data-ref="150src" data-ref-filename="150src">src</a>);</td></tr>
<tr><th id="540">540</th><td>}</td></tr>
<tr><th id="541">541</th><td></td></tr>
<tr><th id="542">542</th><td><i>/* Generic load of register with base and (small) offset address. */</i></td></tr>
<tr><th id="543">543</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_loadofs" title='emit_loadofs' data-ref="emit_loadofs" data-ref-filename="emit_loadofs">emit_loadofs</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col1 decl" id="151as" title='as' data-type='ASMState *' data-ref="151as" data-ref-filename="151as">as</dfn>, <a class="typedef" href="lj_ir.h.html#IRIns" title='IRIns' data-type='union IRIns' data-ref="IRIns" data-ref-filename="IRIns">IRIns</a> *<dfn class="local col2 decl" id="152ir" title='ir' data-type='IRIns *' data-ref="152ir" data-ref-filename="152ir">ir</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col3 decl" id="153r" title='r' data-type='Reg' data-ref="153r" data-ref-filename="153r">r</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col4 decl" id="154base" title='base' data-type='Reg' data-ref="154base" data-ref-filename="154base">base</dfn>, <a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> <dfn class="local col5 decl" id="155ofs" title='ofs' data-type='int32_t' data-ref="155ofs" data-ref-filename="155ofs">ofs</dfn>)</td></tr>
<tr><th id="544">544</th><td>{</td></tr>
<tr><th id="545">545</th><td>  <b>if</b> (<a class="local col3 ref" href="#153r" title='r' data-ref="153r" data-ref-filename="153r">r</a> &lt; <a class="enum" href="lj_target_x86.h.html#RID_MAX_GPR" title='RID_MAX_GPR' data-ref="RID_MAX_GPR" data-ref-filename="RID_MAX_GPR">RID_MAX_GPR</a>)</td></tr>
<tr><th id="546">546</th><td>    <a class="ref fn" href="#emit_rmro" title='emit_rmro' data-ref="emit_rmro" data-ref-filename="emit_rmro">emit_rmro</a>(<a class="local col1 ref" href="#151as" title='as' data-ref="151as" data-ref-filename="151as">as</a>, <a class="enum" href="lj_target_x86.h.html#XO_MOV" title='XO_MOV' data-ref="XO_MOV" data-ref-filename="XO_MOV">XO_MOV</a>, <a class="macro" href="#525" title="((r) + (((((1u&lt;&lt;IRT_NUM)|(1u&lt;&lt;IRT_I64)|(1u&lt;&lt;IRT_U64)|(1u&lt;&lt;IRT_P64)| (1u&lt;&lt;IRT_LIGHTUD)|(1u&lt;&lt;IRT_STR)|(1u&lt;&lt;IRT_THREAD)|(1u&lt;&lt;IRT_PROTO)| (1u&lt;&lt;IRT_FUNC)|(1u&lt;&lt;IRT_CDATA)|(1u&lt;&lt;IRT_TAB)|(1u&lt;&lt;IRT_UDATA)| (1u&lt;&lt;IRT_NIL)) &gt;&gt; ((IRType)(((ir)-&gt;t).irt &amp; IRT_TYPE))) &amp; 1) ? (0x200|0x080000) : 0))" data-ref="_M/REX_64IR">REX_64IR</a>(<a class="local col2 ref" href="#152ir" title='ir' data-ref="152ir" data-ref-filename="152ir">ir</a>, <a class="local col3 ref" href="#153r" title='r' data-ref="153r" data-ref-filename="153r">r</a>), <a class="local col4 ref" href="#154base" title='base' data-ref="154base" data-ref-filename="154base">base</a>, <a class="local col5 ref" href="#155ofs" title='ofs' data-ref="155ofs" data-ref-filename="155ofs">ofs</a>);</td></tr>
<tr><th id="547">547</th><td>  <b>else</b></td></tr>
<tr><th id="548">548</th><td>    <a class="ref fn" href="#emit_rmro" title='emit_rmro' data-ref="emit_rmro" data-ref-filename="emit_rmro">emit_rmro</a>(<a class="local col1 ref" href="#151as" title='as' data-ref="151as" data-ref-filename="151as">as</a>, <a class="macro" href="lj_ir.h.html#363" title="(((IRType)((ir-&gt;t).irt &amp; IRT_TYPE)) == IRT_NUM)" data-ref="_M/irt_isnum">irt_isnum</a>(<a class="local col2 ref" href="#152ir" title='ir' data-ref="152ir" data-ref-filename="152ir">ir</a>-&gt;<a class="ref field" href="lj_ir.h.html#551" title='IRIns::(anonymous struct)::t' data-ref="IRIns::(anonymous)::t" data-ref-filename="IRIns..(anonymous)..t">t</a>) ? <a class="enum" href="lj_target_x86.h.html#XO_MOVSD" title='XO_MOVSD' data-ref="XO_MOVSD" data-ref-filename="XO_MOVSD">XO_MOVSD</a> : <a class="enum" href="lj_target_x86.h.html#XO_MOVSS" title='XO_MOVSS' data-ref="XO_MOVSS" data-ref-filename="XO_MOVSS">XO_MOVSS</a>, <a class="local col3 ref" href="#153r" title='r' data-ref="153r" data-ref-filename="153r">r</a>, <a class="local col4 ref" href="#154base" title='base' data-ref="154base" data-ref-filename="154base">base</a>, <a class="local col5 ref" href="#155ofs" title='ofs' data-ref="155ofs" data-ref-filename="155ofs">ofs</a>);</td></tr>
<tr><th id="549">549</th><td>}</td></tr>
<tr><th id="550">550</th><td></td></tr>
<tr><th id="551">551</th><td><i>/* Generic store of register with base and (small) offset address. */</i></td></tr>
<tr><th id="552">552</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_storeofs" title='emit_storeofs' data-ref="emit_storeofs" data-ref-filename="emit_storeofs">emit_storeofs</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col6 decl" id="156as" title='as' data-type='ASMState *' data-ref="156as" data-ref-filename="156as">as</dfn>, <a class="typedef" href="lj_ir.h.html#IRIns" title='IRIns' data-type='union IRIns' data-ref="IRIns" data-ref-filename="IRIns">IRIns</a> *<dfn class="local col7 decl" id="157ir" title='ir' data-type='IRIns *' data-ref="157ir" data-ref-filename="157ir">ir</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col8 decl" id="158r" title='r' data-type='Reg' data-ref="158r" data-ref-filename="158r">r</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col9 decl" id="159base" title='base' data-type='Reg' data-ref="159base" data-ref-filename="159base">base</dfn>, <a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> <dfn class="local col0 decl" id="160ofs" title='ofs' data-type='int32_t' data-ref="160ofs" data-ref-filename="160ofs">ofs</dfn>)</td></tr>
<tr><th id="553">553</th><td>{</td></tr>
<tr><th id="554">554</th><td>  <b>if</b> (<a class="local col8 ref" href="#158r" title='r' data-ref="158r" data-ref-filename="158r">r</a> &lt; <a class="enum" href="lj_target_x86.h.html#RID_MAX_GPR" title='RID_MAX_GPR' data-ref="RID_MAX_GPR" data-ref-filename="RID_MAX_GPR">RID_MAX_GPR</a>)</td></tr>
<tr><th id="555">555</th><td>    <a class="ref fn" href="#emit_rmro" title='emit_rmro' data-ref="emit_rmro" data-ref-filename="emit_rmro">emit_rmro</a>(<a class="local col6 ref" href="#156as" title='as' data-ref="156as" data-ref-filename="156as">as</a>, <a class="enum" href="lj_target_x86.h.html#XO_MOVto" title='XO_MOVto' data-ref="XO_MOVto" data-ref-filename="XO_MOVto">XO_MOVto</a>, <a class="macro" href="#525" title="((r) + (((((1u&lt;&lt;IRT_NUM)|(1u&lt;&lt;IRT_I64)|(1u&lt;&lt;IRT_U64)|(1u&lt;&lt;IRT_P64)| (1u&lt;&lt;IRT_LIGHTUD)|(1u&lt;&lt;IRT_STR)|(1u&lt;&lt;IRT_THREAD)|(1u&lt;&lt;IRT_PROTO)| (1u&lt;&lt;IRT_FUNC)|(1u&lt;&lt;IRT_CDATA)|(1u&lt;&lt;IRT_TAB)|(1u&lt;&lt;IRT_UDATA)| (1u&lt;&lt;IRT_NIL)) &gt;&gt; ((IRType)(((ir)-&gt;t).irt &amp; IRT_TYPE))) &amp; 1) ? (0x200|0x080000) : 0))" data-ref="_M/REX_64IR">REX_64IR</a>(<a class="local col7 ref" href="#157ir" title='ir' data-ref="157ir" data-ref-filename="157ir">ir</a>, <a class="local col8 ref" href="#158r" title='r' data-ref="158r" data-ref-filename="158r">r</a>), <a class="local col9 ref" href="#159base" title='base' data-ref="159base" data-ref-filename="159base">base</a>, <a class="local col0 ref" href="#160ofs" title='ofs' data-ref="160ofs" data-ref-filename="160ofs">ofs</a>);</td></tr>
<tr><th id="556">556</th><td>  <b>else</b></td></tr>
<tr><th id="557">557</th><td>    <a class="ref fn" href="#emit_rmro" title='emit_rmro' data-ref="emit_rmro" data-ref-filename="emit_rmro">emit_rmro</a>(<a class="local col6 ref" href="#156as" title='as' data-ref="156as" data-ref-filename="156as">as</a>, <a class="macro" href="lj_ir.h.html#363" title="(((IRType)((ir-&gt;t).irt &amp; IRT_TYPE)) == IRT_NUM)" data-ref="_M/irt_isnum">irt_isnum</a>(<a class="local col7 ref" href="#157ir" title='ir' data-ref="157ir" data-ref-filename="157ir">ir</a>-&gt;<a class="ref field" href="lj_ir.h.html#551" title='IRIns::(anonymous struct)::t' data-ref="IRIns::(anonymous)::t" data-ref-filename="IRIns..(anonymous)..t">t</a>) ? <a class="enum" href="lj_target_x86.h.html#XO_MOVSDto" title='XO_MOVSDto' data-ref="XO_MOVSDto" data-ref-filename="XO_MOVSDto">XO_MOVSDto</a> : <a class="enum" href="lj_target_x86.h.html#XO_MOVSSto" title='XO_MOVSSto' data-ref="XO_MOVSSto" data-ref-filename="XO_MOVSSto">XO_MOVSSto</a>, <a class="local col8 ref" href="#158r" title='r' data-ref="158r" data-ref-filename="158r">r</a>, <a class="local col9 ref" href="#159base" title='base' data-ref="159base" data-ref-filename="159base">base</a>, <a class="local col0 ref" href="#160ofs" title='ofs' data-ref="160ofs" data-ref-filename="160ofs">ofs</a>);</td></tr>
<tr><th id="558">558</th><td>}</td></tr>
<tr><th id="559">559</th><td></td></tr>
<tr><th id="560">560</th><td><i>/* Add offset to pointer. */</i></td></tr>
<tr><th id="561">561</th><td><em>static</em> <em>void</em> <dfn class="decl def fn" id="emit_addptr" title='emit_addptr' data-ref="emit_addptr" data-ref-filename="emit_addptr">emit_addptr</dfn>(<a class="typedef" href="lj_asm.c.html#ASMState" title='ASMState' data-type='struct ASMState' data-ref="ASMState" data-ref-filename="ASMState">ASMState</a> *<dfn class="local col1 decl" id="161as" title='as' data-type='ASMState *' data-ref="161as" data-ref-filename="161as">as</dfn>, <a class="typedef" href="lj_target.h.html#Reg" title='Reg' data-type='uint32_t' data-ref="Reg" data-ref-filename="Reg">Reg</a> <dfn class="local col2 decl" id="162r" title='r' data-type='Reg' data-ref="162r" data-ref-filename="162r">r</dfn>, <a class="typedef" href="../include/x86_64-linux-gnu/bits/stdint-intn.h.html#int32_t" title='int32_t' data-type='__int32_t' data-ref="int32_t" data-ref-filename="int32_t">int32_t</a> <dfn class="local col3 decl" id="163ofs" title='ofs' data-type='int32_t' data-ref="163ofs" data-ref-filename="163ofs">ofs</dfn>)</td></tr>
<tr><th id="562">562</th><td>{</td></tr>
<tr><th id="563">563</th><td>  <b>if</b> (<a class="local col3 ref" href="#163ofs" title='ofs' data-ref="163ofs" data-ref-filename="163ofs">ofs</a>) {</td></tr>
<tr><th id="564">564</th><td>    <a class="ref fn" href="#emit_gri" title='emit_gri' data-ref="emit_gri" data-ref-filename="emit_gri">emit_gri</a>(<a class="local col1 ref" href="#161as" title='as' data-ref="161as" data-ref-filename="161as">as</a>, <a class="macro" href="lj_target_x86.h.html#324" title="((x86Group)(((XI_ARITHi8) &lt;&lt; 16) + ((XI_ARITHi) &lt;&lt; 8) + (XOg_ADD)))" data-ref="_M/XG_ARITHi">XG_ARITHi</a>(<a class="enum" href="lj_target_x86.h.html#XOg_ADD" title='XOg_ADD' data-ref="XOg_ADD" data-ref-filename="XOg_ADD">XOg_ADD</a>), <a class="local col2 ref" href="#162r" title='r' data-ref="162r" data-ref-filename="162r">r</a>|<a class="macro" href="#24" title="(0x200|0x080000)" data-ref="_M/REX_GC64">REX_GC64</a>, <a class="local col3 ref" href="#163ofs" title='ofs' data-ref="163ofs" data-ref-filename="163ofs">ofs</a>);</td></tr>
<tr><th id="565">565</th><td>  }</td></tr>
<tr><th id="566">566</th><td>}</td></tr>
<tr><th id="567">567</th><td></td></tr>
<tr><th id="568">568</th><td><u>#define <dfn class="macro" id="_M/emit_spsub" data-ref="_M/emit_spsub">emit_spsub</dfn>(as, ofs)	emit_addptr(as, RID_ESP|REX_64, -(ofs))</u></td></tr>
<tr><th id="569">569</th><td></td></tr>
<tr><th id="570">570</th><td><i>/* Prefer rematerialization of BASE/L from global_State over spills. */</i></td></tr>
<tr><th id="571">571</th><td><u>#define <dfn class="macro" id="_M/emit_canremat" data-ref="_M/emit_canremat">emit_canremat</dfn>(ref)	((ref) &lt;= REF_BASE)</u></td></tr>
<tr><th id="572">572</th><td></td></tr>
<tr><th id="573">573</th><td></td></tr>
</table><hr/><p id='footer'>
Generated while processing <a href='lj_asm.c.html'>luajit/lj_asm.c</a><br/>Generated on <em>2022-Jun-23</em> from project luajit revision <em>v2.1.0-beta3-294-ge9577376</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
